{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./p5.cv.utils.js","webpack:///./p5.cv.utilities.js","webpack:///./p5.cv.helpers.js","webpack:///./p5.cv.wrappers.js","webpack:///./p5.cv.tracker.js","webpack:///./p5.cv.running_background.js","webpack:///./p5.cv.object_finder.js","webpack:///./p5.cv.flow.js","webpack:///./p5.cv.contour_finder.js","webpack:///./app.js"],"names":["p5","cv","prototype","loadOpenCV","onRuntimeInitialized","isReady","onComplete","createFileFromUrl","path","url","callback","request","XMLHttpRequest","open","responseType","onload","ev","readyState","status","data","Uint8Array","response","FS_createDataFile","console","error","send","loadImageToCanvas","cavansId","canvas","document","getElementById","ctx","getContext","img","Image","crossOrigin","width","height","drawImage","src","registerMethod","getWidth","sourceMat","cols","getHeight","rows","getAllocated","getDepthForType","cvImageType","CV_MAT_DEPTH","getDepthForMat","depth","getDepthForImage","CV_8UC4","CV_8UC","channels","CV_8UC1","CV_8UC2","CV_8UC3","CV_8SC","CV_8SC1","CV_8SC2","CV_8SC3","CV_8SC4","CV_16UC","CV_16UC1","CV_16UC2","CV_16UC3","CV_16UC4","CV_16SC","CV_16SC1","CV_16SC2","CV_16SC3","CV_16SC4","CV_32SC","CV_32SC1","CV_32SC2","CV_32SC3","CV_32SC4","CV_32FC","CV_32FC1","CV_32FC2","CV_32FC3","CV_32FC4","CV_64FC","CV_64FC1","CV_64FC2","CV_64FC3","CV_64FC4","CV_CN_MAX","CV_CN_SHIFT","CV_DEPTH_MAX","CV_MAT_CN_MASK","CV_MAT_CN","flags","CV_MAT_DEPTH_MASK","CV_MAKETYPE","cn","getCvImageType","cvDepth","CV_8U","getCvImageTypeForImage","getChannelsForType","getChannelsForImage","getChannelsForMat","copyTo","destinationMat","type","alpha","getMaxVal","convertTo","copy","dstDepth","allocate","cvType","create","imitateWithType","mirror","original","mirrorCvImageType","ow","oh","imitate","getMaxValForDepth","CV_16U","CV_8S","CV_16S","CV_32S","CV_32F","CV_64F","getMaxValForMat","mat","getColorConversionTypes","types","property","indexOf","push","getTargetChannelsFromCode","conversionCode","COLOR_RGB2RGBA","COLOR_RGBA2RGB","COLOR_RGB2BGRA","COLOR_RGBA2BGR","COLOR_BGR2RGB","COLOR_BGRA2RGBA","COLOR_BGR2GRAY","COLOR_RGB2GRAY","COLOR_GRAY2RGB","COLOR_GRAY2RGBA","COLOR_BGRA2GRAY","COLOR_RGBA2GRAY","COLOR_BGR5652BGR","COLOR_BGR5652RGB","COLOR_BGR5652BGRA","COLOR_BGR5652RGBA","COLOR_BGR5652GRAY","COLOR_BGR5552BGR","COLOR_BGR5552RGB","COLOR_BGR5552BGRA","COLOR_BGR5552RGBA","COLOR_BGR5552GRAY","COLOR_BGR2XYZ","COLOR_RGB2XYZ","COLOR_XYZ2BGR","COLOR_XYZ2RGB","COLOR_BGR2YCrCb","COLOR_RGB2YCrCb","COLOR_YCrCb2BGR","COLOR_YCrCb2RGB","COLOR_BGR2HSV","COLOR_RGB2HSV","COLOR_BGR2Lab","COLOR_RGB2Lab","COLOR_BayerGB2BGR","COLOR_BayerBG2RGB","COLOR_BayerGB2RGB","COLOR_BayerRG2RGB","COLOR_BGR2Luv","COLOR_RGB2Luv","COLOR_BGR2HLS","COLOR_RGB2HLS","COLOR_HSV2BGR","COLOR_HSV2RGB","COLOR_Lab2BGR","COLOR_Lab2RGB","COLOR_Luv2BGR","COLOR_Luv2RGB","COLOR_HLS2BGR","COLOR_HLS2RGB","COLOR_BayerBG2RGB_VNG","COLOR_BayerGB2RGB_VNG","COLOR_BayerRG2RGB_VNG","COLOR_BayerGR2RGB_VNG","COLOR_BGR2HSV_FULL","COLOR_RGB2HSV_FULL","COLOR_BGR2HLS_FULL","COLOR_RGB2HLS_FULL","COLOR_HSV2BGR_FULL","COLOR_HSV2RGB_FULL","COLOR_HLS2BGR_FULL","COLOR_HLS2RGB_FULL","COLOR_LBGR2Lab","COLOR_LRGB2Lab","COLOR_LBGR2Luv","COLOR_LRGB2Luv","COLOR_Lab2LBGR","COLOR_Lab2LRGB","COLOR_Luv2LBGR","COLOR_Luv2LRGB","COLOR_BGR2YUV","COLOR_RGB2YUV","COLOR_YUV2BGR","COLOR_YUV2RGB","pixelsToCvMat","pixels","matFromArray","imageDataToCvMat","imageData","matFromImageData","vectorsToCvContour","points","length","map","pt","x","y","flat","colorToCvScalar","color","Color","levels","Array","warn","cvRotatedRectToPoints","rect","RotatedRect","cvRotatedRectToVectors","createVector","cvContourToPoints","contour","cvPointsToJS","cvPointToVector","point","cvRectVectorToArray","rectVector","array","rectVectorSize","size","i","get","ZERO_SCALAR","makeMatrix","rotation","translation","rot3x3","Mat","Rodrigues","rm","data32F","tm","applyMatrix","transformationMatrix4x4","drawMat","p5Image","matToNewImage","image","drawVectors","vectors","close","numVectors","vector","beginShape","vertex","endShape","drawRotatedRect","rotatedRect","center","translate","rotate","radians","angle","pop","drawRotatedEllipse","rotatedEllipse","ellipse","findMaxLocation","minMaxLoc","maxLoc","meanCols","colMat","row","mean","col","meanRows","rowMat","sumData","reduce","a","b","sumCols","sumRows","minCols","minVal","minRows","maxCols","maxVal","maxRows","findFirst","target","charAt","findLast","getBoundingBox","thresh","invert","THRESH_BINARY_INV","THRESH_BINARY","box","Rect","threshold","weightedAverageAngle","linesMat","angleSum","weights","start","Point","data32S","end","diff","Vector","sub","mag","weight","atan2","autorotate","threshold1","threshold2","threshMat","Canny","lines","distanceResolution","angleResolution","PI","voteThreshold","minLineLength","srcMat","maxLineGap","HoughLinesP","rotationAmount","ofRadToDeg","imageToNewMat","sourceImage","imread","imageToMat","cvMat","sourceWidth","sourceHeight","getImageData","set","getCvVideoCapture","p5Capture","VideoCapture","elt","getRGBAMat","zeros","getRGBMat","getGrayscaleMat","matToImage","destinationImage","imshow","createImage","areSamesize","matA","matB","Scalar","add","invertTo","bitwise_not","lerp","lerpFromMat","lerpToMat","lerpResult","amount","addWeighted","accumulate","newMat","accumulatorMat","accumulateWeighted","mask","normalizeTo","normalize","NORM_MINMAX","thresholdTo","thresholdValue","thresholdType","MINUS_ONE_POINT","erodeTo","iterations","erode","dilateTo","dilate","autothresholdTo","THRESH_OTSU","autothreshold","convertColor","code","targetChannels","cvtColor","convertSingleColor","p5Color","from","copyGray","copyRGB","forceOdd","Math","floor","blurTo","blur","Size","GaussianBlurTo","GaussianBlur","medianBlurTo","medianBlur","equalizeHistTo","sourceChannels","MatVector","destinationChannels","split","equalizeHist","merge","apertureSize","L2gradient","Sobel","ddepth","dx","dy","ksize","scale","delta","borderType","BORDER_DEFAULT","warpPerspective","destinationPoints","INTER_LINEAR","w","h","sourcePoints","transform","getPerspectiveTransform","unwarpPerspective","warpPerspectiveFromTranform","resizeTo","interpolation","resize","resizeToScale","xScale","yScale","dstWidth","dstHeight","resizeToDimensions","result","drawContour","cvPointsToVectors","cvFeaturesToPoints","getFeatureAsPoint","index","cvLineToJS","cvLineToVectors","getConvexHullMat","contourMat","hull","convexHull","convexHullFromMat","convexityDefectsCv","defects","convexityDefects","convexityDefectsFromVectors","minAreaRectFromVectors","minAreaRect","fitEllipseFromVectors","fitEllipse","fitLineFromVectors","line","fitLine","DIST_L2","vx","vy","lefty","round","righty","point1","point2","fillPoly","numPoints","setTo","FLIP_HORIZONTAL","FLIP_VERTICAL","FLIP_BOTH","flipTo","flip","rotateTo","fill","rotationMatrix","getRotationMatrix2D","warpAffine","BORDER_CONSTANT","rotate90To","transpose","rotate90","transposeTo","swap","temp","clone","trackingDistanceRect","dw","dh","pd","sqrt","sd","trackingDistancePoint","dist","isPoint","isRect","trackingDistance","TrackedObject","object","label","lastSeen","age","previous","old","visible","Tracker","current","currentLabels","previousLabels","newLabels","deadLabels","previousLabelMap","Map","currentLabelMap","persistence","curLabel","maximumDistance","persistance","distance","objects","concat","n","m","all","j","curDistance","pair","sort","sortByDistance","matchedObjects","matchedPrevious","allSize","k","match","newFromPrevious","initFromPreviousObject","timeStep","getLabel","getNewLabel","newWithLabel","initFromObject","getLastSeen","clear","currentSize","previousSize","has","getIndex","getAge","RectTracker","smoothingRate","smoothed","labels","labelsSize","cur","getCurrent","smooth","entries","trackedRect","existsCurrent","getLabelFromIndex","existsPrevious","getPrevious","previousPosition","currentPosition","PointTracker","Follower","dead","track","RectFollower","PointFollower","TrackerFollower","followers","curFollower","kill","update","newLabelsSize","newFollower","setup","setLabel","getDead","splice","RectTrackerFollower","PointTrackerFollower","DifferenceMode","ABSDIFF","BRIGHTER","DARKER","RunningBackground","learningRate","learningTime","useLearningTime","ignoreForeground","needToReset","differenceMode","accumulator","background","foreground","foregroundGray","frame","thresholded","empty","absdiff","subtract","thresholdMode","curLearningRate","float","pow","ObjectFinder","rescale","multiScaleFactor","minNeighbors","minSizeScale","maxSizeScale","useHistogramEqualization","cannyPrunning","findBiggestObject","gray","graySmall","classifier","CascadeClassifier","tracker","cascadeFilename","load","newFrameMat","minSize","maxSize","minSide","min","side","RectVector","detectMultiScale","cannyPruning","CASCADE_DO_CANNY_PRUNING","CASCADE_FIND_BIGGEST_OBJECT","CASCADE_DO_ROUGH_SEARCH","objectsSize","getSmoothed","getVelocity","getCurrentLabels","noFill","stroke","getObject","text","preset","FAST","setRescale","setMinNeighbors","setMultiScaleFactor","setMinSizeScale","setMaxSizeScale","setCannyPruning","setFindBiggestObject","ACCURATE","SENSITIVE","Flow","last","curr","hasFlow","lastMat","currentMat","calcFlow","lastSize","currSize","renderWidth","renderHeight","drawFlow","prevMat","nextMat","FlowPyrLK","prevPts","nextPts","windowSize","maxLevel","maxFeatures","maxCorners","blockSize","qualityLevel","minDistance","criteria","TermCriteria","TERM_CRITERIA_EPS","TERM_CRITERIA_COUNT","pyramidLevels","calcFeaturesNextFrame","pyramid","prevPyramid","err","winSize","featuresSize","features","resetFeaturesToTrack","drawX","drawY","drawWidth","drawHeight","scaleX","scaleY","prevPtsSize","LINES","calcFeaturesToTrack","calcOpticalFlowPyrLK","goodFeaturesToTrack","FlowFarneback","flow","pyramidScale","numLevels","numIterations","polyN","polySigma","farnebackGaussian","renderStep","constrain","gaussian","OPTFLOW_USE_INITIAL_FLOW","OPTFLOW_FARNEBACK_GAUSSIAN","calcOpticalFlowFarneback","getTotalFlowInRegion","getAverageFlowInRegion","xIndex","yIndex","position","getFlowOffset","regionX","regionY","regionWidth","regionHeight","total","rectX","rectY","rectWidth","rectHeight","log","flowPosition","getFlowPosition","Graph","historyLength","minValue","maxValue","history","Float32Array","sample","offset","range","strokeWeight","normalized","samePixels","a1","a2","stride","same","matAGray","matBGray","countNonZero","OFlow","step","uMotionGraph","vMotionGraph","newImage","oldImage","zones","winStep","A2","A1B2","B1","C1","C2","u","v","uu","vv","wMax","hMax","globalY","globalX","localY","localX","address","gradX","gradY","gradT","Idelta","deltaX","deltaY","norm","IGradNorm","addSample","forEach","zone","draw","TrackingColorMode","TRACK_COLOR_RGB","TRACK_COLOR_HSV","TRACK_COLOR_H","TRACK_COLOR_HS","ContourFinder","hsvBuffer","autoThreshold","simplify","thresholdValueMax","useTargetColor","trackingColorMode","targetColor","minArea","maxArea","Number","POSITIVE_INFINITY","minAreaNorm","maxAreaNorm","contours","polylines","boundingRects","holes","contourFindingMode","RETR_EXTERNAL","sortBySize","resetMinArea","resetMaxArea","base","lowerb","upperb","inRange","allContours","hierarchy","simplifyMode","CHAIN_APPROX_SIMPLE","CHAIN_APPROX_NONE","findContours","needMinFilter","needMaxFilter","allIndices","allAreas","allHoles","imgArea","imgMinArea","imgMaxArea","curArea","contourArea","hole","allIndicesSize","boundingRect","findHoles","RETR_LIST","sizeSort","getBoundingRect","moments","m00","m10","m01","cvPoint","average","getCentroid","getCenter","arcLength","minEnclosingCircle","getMinAreaRect","getConvexHull","quad","targetPoints","maxIterations","infinity","minEpsilon","maxEpsilon","curEpsilon","approxPolyDP","polylinesSize","setMinArea","setMaxArea","minAreaRadius","maxAreaRadius","window"],"mappings":"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","file":"p5.cv.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","// OpenCV.js <-> p5.js setup\np5.cv = {};\np5.prototype.loadOpenCV = function () {\n  // from https://docs.opencv.org/4.4.0/utils.js\n\n  cv.onRuntimeInitialized = function () {\n    p5.cv.isReady = true;\n    if (p5.cv.onComplete) {\n      p5.cv.onComplete();\n    }\n  };\n\n  p5.cv.createFileFromUrl = function (path, url, callback) {\n    let request = new XMLHttpRequest();\n    request.open('GET', url, true);\n    request.responseType = 'arraybuffer';\n    request.onload = function (ev) {\n      if (request.readyState === 4) {\n        if (request.status === 200) {\n          let data = new Uint8Array(request.response);\n          cv.FS_createDataFile('/', path, data, true, false, false);\n          callback();\n        } else {\n          console.error('Failed to load ' + url + ' status: ' + request.status);\n        }\n      }\n    };\n    request.send();\n  };\n\n  p5.cv.loadImageToCanvas = function (url, cavansId) {\n    let canvas = document.getElementById(cavansId);\n    let ctx = canvas.getContext('2d');\n    let img = new Image();\n    img.crossOrigin = 'anonymous';\n    img.onload = function () {\n      canvas.width = img.width;\n      canvas.height = img.height;\n      ctx.drawImage(img, 0, 0, img.width, img.height);\n    };\n    img.src = url;\n  };\n};\n\np5.prototype.registerMethod('init', p5.prototype.loadOpenCV);\n","// Utilities.h\n\np5.cv.getWidth = function (sourceMat) {\n  return sourceMat.cols;\n};\np5.cv.getHeight = function (sourceMat) {\n  return sourceMat.rows;\n};\np5.cv.getAllocated = function (sourceMat) {\n  //return p5.cv.getWidth(sourceMat) > 0 && p5.cv.getHeight(sourceMat) > 0;\n  return sourceMat.rows > 0 && sourceMat.cols > 0;\n};\np5.cv.getDepthForType = function (cvImageType) {\n  return cv.CV_MAT_DEPTH(cvImageType);\n};\np5.cv.getDepthForMat = function (sourceMat) {\n  return sourceMat.depth();\n};\n// p5.Image / p5.Graphics will use Canvas = RGBA\np5.cv.getDepthForImage = function () {\n  return cv.CV_8UC4;\n};\ncv.CV_8UC = function (channels) {\n  if (channels === 1) return cv.CV_8UC1;\n  if (channels === 2) return cv.CV_8UC2;\n  if (channels === 3) return cv.CV_8UC3;\n  if (channels === 4) return cv.CV_8UC4;\n  return cv.CV_8UC1;\n};\ncv.CV_8SC = function (channels) {\n  if (channels === 1) return cv.CV_8SC1;\n  if (channels === 2) return cv.CV_8SC2;\n  if (channels === 3) return cv.CV_8SC3;\n  if (channels === 4) return cv.CV_8SC4;\n  return cv.CV_8SC1;\n};\ncv.CV_16UC = function (channels) {\n  if (channels === 1) return cv.CV_16UC1;\n  if (channels === 2) return cv.CV_16UC2;\n  if (channels === 3) return cv.CV_16UC3;\n  if (channels === 4) return cv.CV_16UC4;\n  return cv.CV_16UC1;\n};\ncv.CV_16SC = function (channels) {\n  if (channels === 1) return cv.CV_16SC1;\n  if (channels === 2) return cv.CV_16SC2;\n  if (channels === 3) return cv.CV_16SC3;\n  if (channels === 4) return cv.CV_16SC4;\n  return cv.CV_16SC1;\n};\ncv.CV_32SC = function (channels) {\n  if (channels === 1) return cv.CV_32SC1;\n  if (channels === 2) return cv.CV_32SC2;\n  if (channels === 3) return cv.CV_32SC3;\n  if (channels === 4) return cv.CV_32SC4;\n  return cv.CV_32SC1;\n};\ncv.CV_32FC = function (channels) {\n  if (channels === 1) return cv.CV_32FC1;\n  if (channels === 2) return cv.CV_32FC2;\n  if (channels === 3) return cv.CV_32FC3;\n  if (channels === 4) return cv.CV_32FC4;\n  return cv.CV_32FC1;\n};\ncv.CV_64FC = function (channels) {\n  if (channels === 1) return cv.CV_64FC1;\n  if (channels === 2) return cv.CV_64FC2;\n  if (channels === 3) return cv.CV_64FC3;\n  if (channels === 4) return cv.CV_64FC4;\n  return cv.CV_64FC1;\n};\n\ncv.CV_CN_MAX = 512;\ncv.CV_CN_SHIFT = 3;\ncv.CV_DEPTH_MAX = 1 << cv.CV_CN_SHIFT;\n// #define CV_MAT_CN_MASK          ((CV_CN_MAX - 1) << CV_CN_SHIFT)\ncv.CV_MAT_CN_MASK = (cv.CV_CN_MAX - 1) << cv.CV_CN_SHIFT;\ncv.CV_MAT_CN = function (flags) {\n  return ((flags & cv.CV_MAT_CN_MASK) >> cv.CV_CN_SHIFT) + 1;\n};\ncv.CV_MAT_DEPTH_MASK = cv.CV_DEPTH_MAX - 1;\ncv.CV_MAT_DEPTH = function (flags) {\n  return flags & cv.CV_MAT_DEPTH_MASK;\n};\ncv.CV_MAKETYPE = function (depth, cn) {\n  return cv.CV_MAT_DEPTH(depth) + ((cn - 1) << cv.CV_CN_SHIFT);\n};\np5.cv.getCvImageType = function (channels, cvDepth = cv.CV_8U) {\n  return cv.CV_MAKETYPE(cvDepth, channels);\n};\np5.cv.getCvImageTypeForImage = function (cvDepth = CV_8U) {\n  return cv.CV_MAKETYPE(cvDepth, 4);\n};\np5.cv.getChannelsForType = function (cvImageType) {\n  return cv.CV_MAT_CN(cvImageType);\n};\n// p5.Image / p5.Graphics will use Canvas = RGBA\np5.cv.getChannelsForImage = function () {\n  return 4;\n};\np5.cv.getChannelsForMat = function (sourceMat) {\n  return sourceMat.channels();\n};\np5.cv.copyTo = function (sourceMat, destinationMat) {\n  if (sourceMat.type() === destinationMat.type()) {\n    sourceMat.copyTo(destinationMat);\n  } else {\n    let alpha = p5.cv.getMaxVal(destinationMat) / p5.cv.getMaxVal(sourceMat);\n    sourceMat.convertTo(destinationMat, destinationMat.depth(), alpha);\n  }\n};\np5.cv.copy = function (sourceMat, destinationMat) {\n  let dstDepth;\n  if (p5.cv.getAllocated(destinationMat)) {\n    dstDepth = p5.cv.getDepthForMat(destinationMat);\n  } else {\n    dstDepth = p5.cv.getDepthForMat(sourceMat);\n  }\n  p5.cv.copyTo(sourceMat, destinationMat, dstDepth);\n};\n\np5.cv.allocate = function (sourceMat, width, height, cvType) {\n  if (\n    p5.cv.getWidth(sourceMat) !== width ||\n    p5.cv.getHeight(sourceMat) !== height ||\n    p5.cv.getCvImageType(sourceMat) !== cvType\n  ) {\n    sourceMat.create(height, width, cvType);\n  }\n};\np5.cv.imitateWithType = function (mirror, original, mirrorCvImageType) {\n  let ow = p5.cv.getWidth(original),\n    oh = p5.cv.getHeight(original);\n  p5.cv.allocate(mirror, ow, oh, mirrorCvImageType);\n};\np5.cv.imitate = function (mirror, original) {\n  p5.cv.imitateWithType(mirror, original, p5.cv.getCvImageType(original));\n};\n// maximum possible values for that depth or matrix\np5.cv.getMaxValForDepth = function (cvDepth) {\n  switch (cvDepth) {\n    case cv.CV_8U:\n      return 255;\n    case cv.CV_16U:\n      return 65535;\n\n    case cv.CV_8S:\n      return 127;\n    case cv.CV_16S:\n      return 32767;\n    case cv.CV_32S:\n      return 2147483647;\n\n    case cv.CV_32F:\n      return 1.0;\n    case cv.CV_64F:\n    default:\n      return 1.0;\n  }\n};\n\np5.cv.getMaxValForMat = function (mat) {\n  return p5.cv.getMaxValForDepth(mat.depth());\n};\n\n// float getMaxVal(const cv::Mat& mat);\np5.cv.getColorConversionTypes = function () {\n  let types = [];\n  for (property in cv) {\n    if (property.indexOf('COLOR_') === 0) {\n      types.push(property);\n    }\n  }\n  return types;\n};\np5.cv.getTargetChannelsFromCode = function (conversionCode) {\n  // TODO: add the rest of the modes\n  // [\"COLOR_BGR2BGR555\",\"COLOR_BGR2BGR565\",\"COLOR_BGR2BGRA\",\"COLOR_BGR2GRAY\",\"COLOR_BGR2HLS\",\"COLOR_BGR2HLS_FULL\",\"COLOR_BGR2HSV\",\"COLOR_BGR2HSV_FULL\",\"COLOR_BGR2Lab\",\"COLOR_BGR2Luv\",\"COLOR_BGR2RGB\",\"COLOR_BGR2RGBA\",\"COLOR_BGR2XYZ\",\"COLOR_BGR2YCrCb\",\"COLOR_BGR2YUV\",\"COLOR_BGR2YUV_I420\",\"COLOR_BGR2YUV_IYUV\",\"COLOR_BGR2YUV_YV12\",\"COLOR_BGR5552BGR\",\"COLOR_BGR5552BGRA\",\"COLOR_BGR5552GRAY\",\"COLOR_BGR5552RGB\",\"COLOR_BGR5552RGBA\",\"COLOR_BGR5652BGR\",\"COLOR_BGR5652BGRA\",\"COLOR_BGR5652GRAY\",\"COLOR_BGR5652RGB\",\"COLOR_BGR5652RGBA\",\"COLOR_BGRA2BGR\",\"COLOR_BGRA2BGR555\",\"COLOR_BGRA2BGR565\",\"COLOR_BGRA2GRAY\",\"COLOR_BGRA2RGB\",\"COLOR_BGRA2RGBA\",\"COLOR_BGRA2YUV_I420\",\"COLOR_BGRA2YUV_IYUV\",\"COLOR_BGRA2YUV_YV12\",\"COLOR_BayerBG2BGR\",\"COLOR_BayerBG2BGRA\",\"COLOR_BayerBG2BGR_EA\",\"COLOR_BayerBG2BGR_VNG\",\"COLOR_BayerBG2GRAY\",\"COLOR_BayerBG2RGB\",\"COLOR_BayerBG2RGBA\",\"COLOR_BayerBG2RGB_EA\",\"COLOR_BayerBG2RGB_VNG\",\"COLOR_BayerGB2BGR\",\"COLOR_BayerGB2BGRA\",\"COLOR_BayerGB2BGR_EA\",\"COLOR_BayerGB2BGR_VNG\",\"COLOR_BayerGB2GRAY\",\"COLOR_BayerGB2RGB\",\"COLOR_BayerGB2RGBA\",\"COLOR_BayerGB2RGB_EA\",\"COLOR_BayerGB2RGB_VNG\",\"COLOR_BayerGR2BGR\",\"COLOR_BayerGR2BGRA\",\"COLOR_BayerGR2BGR_EA\",\"COLOR_BayerGR2BGR_VNG\",\"COLOR_BayerGR2GRAY\",\"COLOR_BayerGR2RGB\",\"COLOR_BayerGR2RGBA\",\"COLOR_BayerGR2RGB_EA\",\"COLOR_BayerGR2RGB_VNG\",\"COLOR_BayerRG2BGR\",\"COLOR_BayerRG2BGRA\",\"COLOR_BayerRG2BGR_EA\",\"COLOR_BayerRG2BGR_VNG\",\"COLOR_BayerRG2GRAY\",\"COLOR_BayerRG2RGB\",\"COLOR_BayerRG2RGBA\",\"COLOR_BayerRG2RGB_EA\",\"COLOR_BayerRG2RGB_VNG\",\"COLOR_GRAY2BGR\",\"COLOR_GRAY2BGR555\",\"COLOR_GRAY2BGR565\",\"COLOR_GRAY2BGRA\",\"COLOR_GRAY2RGB\",\"COLOR_GRAY2RGBA\",\"COLOR_HLS2BGR\",\"COLOR_HLS2BGR_FULL\",\"COLOR_HLS2RGB\",\"COLOR_HLS2RGB_FULL\",\"COLOR_HSV2BGR\",\"COLOR_HSV2BGR_FULL\",\"COLOR_HSV2RGB\",\"COLOR_HSV2RGB_FULL\",\"COLOR_LBGR2Lab\",\"COLOR_LBGR2Luv\",\"COLOR_LRGB2Lab\",\"COLOR_LRGB2Luv\",\"COLOR_Lab2BGR\",\"COLOR_Lab2LBGR\",\"COLOR_Lab2LRGB\",\"COLOR_Lab2RGB\",\"COLOR_Luv2BGR\",\"COLOR_Luv2LBGR\",\"COLOR_Luv2LRGB\",\"COLOR_Luv2RGB\",\"COLOR_RGB2BGR\",\"COLOR_RGB2BGR555\",\"COLOR_RGB2BGR565\",\"COLOR_RGB2BGRA\",\"COLOR_RGB2GRAY\",\"COLOR_RGB2HLS\",\"COLOR_RGB2HLS_FULL\",\"COLOR_RGB2HSV\",\"COLOR_RGB2HSV_FULL\",\"COLOR_RGB2Lab\",\"COLOR_RGB2Luv\",\"COLOR_RGB2RGBA\",\"COLOR_RGB2XYZ\",\"COLOR_RGB2YCrCb\",\"COLOR_RGB2YUV\",\"COLOR_RGB2YUV_I420\",\"COLOR_RGB2YUV_IYUV\",\"COLOR_RGB2YUV_YV12\",\"COLOR_RGBA2BGR\",\"COLOR_RGBA2BGR555\",\"COLOR_RGBA2BGR565\",\"COLOR_RGBA2BGRA\",\"COLOR_RGBA2GRAY\",\"COLOR_RGBA2RGB\",\"COLOR_RGBA2YUV_I420\",\"COLOR_RGBA2YUV_IYUV\",\"COLOR_RGBA2YUV_YV12\",\"COLOR_RGBA2mRGBA\",\"COLOR_XYZ2BGR\",\"COLOR_XYZ2RGB\",\"COLOR_YCrCb2BGR\",\"COLOR_YCrCb2RGB\",\"COLOR_YUV2BGR\",\"COLOR_YUV2BGRA_I420\",\"COLOR_YUV2BGRA_IYUV\",\"COLOR_YUV2BGRA_NV12\",\"COLOR_YUV2BGRA_NV21\",\"COLOR_YUV2BGRA_UYNV\",\"COLOR_YUV2BGRA_UYVY\",\"COLOR_YUV2BGRA_Y422\",\"COLOR_YUV2BGRA_YUNV\",\"COLOR_YUV2BGRA_YUY2\",\"COLOR_YUV2BGRA_YUYV\",\"COLOR_YUV2BGRA_YV12\",\"COLOR_YUV2BGRA_YVYU\",\"COLOR_YUV2BGR_I420\",\"COLOR_YUV2BGR_IYUV\",\"COLOR_YUV2BGR_NV12\",\"COLOR_YUV2BGR_NV21\",\"COLOR_YUV2BGR_UYNV\",\"COLOR_YUV2BGR_UYVY\",\"COLOR_YUV2BGR_Y422\",\"COLOR_YUV2BGR_YUNV\",\"COLOR_YUV2BGR_YUY2\",\"COLOR_YUV2BGR_YUYV\",\"COLOR_YUV2BGR_YV12\",\"COLOR_YUV2BGR_YVYU\",\"COLOR_YUV2GRAY_420\",\"COLOR_YUV2GRAY_I420\",\"COLOR_YUV2GRAY_IYUV\",\"COLOR_YUV2GRAY_NV12\",\"COLOR_YUV2GRAY_NV21\",\"COLOR_YUV2GRAY_UYNV\",\"COLOR_YUV2GRAY_UYVY\",\"COLOR_YUV2GRAY_Y422\",\"COLOR_YUV2GRAY_YUNV\",\"COLOR_YUV2GRAY_YUY2\",\"COLOR_YUV2GRAY_YUYV\",\"COLOR_YUV2GRAY_YV12\",\"COLOR_YUV2GRAY_YVYU\",\"COLOR_YUV2RGB\",\"COLOR_YUV2RGBA_I420\",\"COLOR_YUV2RGBA_IYUV\",\"COLOR_YUV2RGBA_NV12\",\"COLOR_YUV2RGBA_NV21\",\"COLOR_YUV2RGBA_UYNV\",\"COLOR_YUV2RGBA_UYVY\",\"COLOR_YUV2RGBA_Y422\",\"COLOR_YUV2RGBA_YUNV\",\"COLOR_YUV2RGBA_YUY2\",\"COLOR_YUV2RGBA_YUYV\",\"COLOR_YUV2RGBA_YV12\",\"COLOR_YUV2RGBA_YVYU\",\"COLOR_YUV2RGB_I420\",\"COLOR_YUV2RGB_IYUV\",\"COLOR_YUV2RGB_NV12\",\"COLOR_YUV2RGB_NV21\",\"COLOR_YUV2RGB_UYNV\",\"COLOR_YUV2RGB_UYVY\",\"COLOR_YUV2RGB_Y422\",\"COLOR_YUV2RGB_YUNV\",\"COLOR_YUV2RGB_YUY2\",\"COLOR_YUV2RGB_YUYV\",\"COLOR_YUV2RGB_YV12\",\"COLOR_YUV2RGB_YVYU\",\"COLOR_YUV420p2BGR\",\"COLOR_YUV420p2BGRA\",\"COLOR_YUV420p2GRAY\",\"COLOR_YUV420p2RGB\",\"COLOR_YUV420p2RGBA\",\"COLOR_YUV420sp2BGR\",\"COLOR_YUV420sp2BGRA\",\"COLOR_YUV420sp2GRAY\",\"COLOR_YUV420sp2RGB\",\"COLOR_YUV420sp2RGBA\",\"COLOR_mRGBA2RGBA\"]\n  if (conversionCode === cv.COLOR_RGB2RGBA) return 4;\n  if (conversionCode === cv.COLOR_RGBA2RGB) return 3;\n  if (conversionCode === cv.COLOR_RGB2BGRA) return 4;\n  if (conversionCode === cv.COLOR_RGBA2BGR) return 3;\n  if (conversionCode === cv.COLOR_BGR2RGB) return 3;\n  if (conversionCode === cv.COLOR_BGRA2RGBA) return 4;\n  if (conversionCode === cv.COLOR_BGR2GRAY) return 1;\n  if (conversionCode === cv.COLOR_RGB2GRAY) return 1;\n  if (conversionCode === cv.COLOR_GRAY2RGB) return 3;\n  if (conversionCode === cv.COLOR_GRAY2RGBA) return 4;\n  if (conversionCode === cv.COLOR_BGRA2GRAY) return 1;\n  if (conversionCode === cv.COLOR_RGBA2GRAY) return 1;\n  if (conversionCode === cv.COLOR_BGR5652BGR) return 3;\n  if (conversionCode === cv.COLOR_BGR5652RGB) return 3;\n  if (conversionCode === cv.COLOR_BGR5652BGRA) return 4;\n  if (conversionCode === cv.COLOR_BGR5652RGBA) return 4;\n  if (conversionCode === cv.COLOR_BGR5652GRAY) return 1;\n  if (conversionCode === cv.COLOR_BGR5552BGR) return 3;\n  if (conversionCode === cv.COLOR_BGR5552RGB) return 3;\n  if (conversionCode === cv.COLOR_BGR5552BGRA) return 4;\n  if (conversionCode === cv.COLOR_BGR5552RGBA) return 4;\n  if (conversionCode === cv.COLOR_BGR5552GRAY) return 1;\n  if (conversionCode === cv.COLOR_BGR2XYZ) return 3;\n  if (conversionCode === cv.COLOR_RGB2XYZ) return 3;\n  if (conversionCode === cv.COLOR_XYZ2BGR) return 3;\n  if (conversionCode === cv.COLOR_XYZ2RGB) return 3;\n  if (conversionCode === cv.COLOR_BGR2YCrCb) return 3;\n  if (conversionCode === cv.COLOR_RGB2YCrCb) return 3;\n  if (conversionCode === cv.COLOR_YCrCb2BGR) return 3;\n  if (conversionCode === cv.COLOR_YCrCb2RGB) return 3;\n  if (conversionCode === cv.COLOR_BGR2HSV) return 3;\n  if (conversionCode === cv.COLOR_RGB2HSV) return 3;\n  if (conversionCode === cv.COLOR_BGR2Lab) return 3;\n  if (conversionCode === cv.COLOR_RGB2Lab) return 3;\n  if (conversionCode === cv.COLOR_BayerGB2BGR) return 3;\n  if (conversionCode === cv.COLOR_BayerBG2RGB) return 3;\n  if (conversionCode === cv.COLOR_BayerGB2RGB) return 3;\n  if (conversionCode === cv.COLOR_BayerRG2RGB) return 3;\n  if (conversionCode === cv.COLOR_BGR2Luv) return 3;\n  if (conversionCode === cv.COLOR_RGB2Luv) return 3;\n  if (conversionCode === cv.COLOR_BGR2HLS) return 3;\n  if (conversionCode === cv.COLOR_RGB2HLS) return 3;\n  if (conversionCode === cv.COLOR_HSV2BGR) return 3;\n  if (conversionCode === cv.COLOR_HSV2RGB) return 3;\n  if (conversionCode === cv.COLOR_Lab2BGR) return 3;\n  if (conversionCode === cv.COLOR_Lab2RGB) return 3;\n  if (conversionCode === cv.COLOR_Luv2BGR) return 3;\n  if (conversionCode === cv.COLOR_Luv2RGB) return 3;\n  if (conversionCode === cv.COLOR_HLS2BGR) return 3;\n  if (conversionCode === cv.COLOR_HLS2RGB) return 3;\n  if (conversionCode === cv.COLOR_BayerBG2RGB_VNG) return 3;\n  if (conversionCode === cv.COLOR_BayerGB2RGB_VNG) return 3;\n  if (conversionCode === cv.COLOR_BayerRG2RGB_VNG) return 3;\n  if (conversionCode === cv.COLOR_BayerGR2RGB_VNG) return 3;\n  if (conversionCode === cv.COLOR_BGR2HSV_FULL) return 3;\n  if (conversionCode === cv.COLOR_RGB2HSV_FULL) return 3;\n  if (conversionCode === cv.COLOR_BGR2HLS_FULL) return 3;\n  if (conversionCode === cv.COLOR_RGB2HLS_FULL) return 3;\n  if (conversionCode === cv.COLOR_HSV2BGR_FULL) return 3;\n  if (conversionCode === cv.COLOR_HSV2RGB_FULL) return 3;\n  if (conversionCode === cv.COLOR_HLS2BGR_FULL) return 3;\n  if (conversionCode === cv.COLOR_HLS2RGB_FULL) return 3;\n  if (conversionCode === cv.COLOR_LBGR2Lab) return 3;\n  if (conversionCode === cv.COLOR_LRGB2Lab) return 3;\n  if (conversionCode === cv.COLOR_LBGR2Luv) return 3;\n  if (conversionCode === cv.COLOR_LRGB2Luv) return 3;\n  if (conversionCode === cv.COLOR_Lab2LBGR) return 4;\n  if (conversionCode === cv.COLOR_Lab2LRGB) return 4;\n  if (conversionCode === cv.COLOR_Luv2LBGR) return 4;\n  if (conversionCode === cv.COLOR_Luv2LRGB) return 4;\n  if (conversionCode === cv.COLOR_BGR2YUV) return 3;\n  if (conversionCode === cv.COLOR_RGB2YUV) return 3;\n  if (conversionCode === cv.COLOR_YUV2BGR) return 3;\n  if (conversionCode === cv.COLOR_YUV2RGB) return 3;\n  return 0;\n};\n\np5.cv.pixelsToCvMat = function (width, height, pixels) {\n  return cv.matFromArray(width, height, cv.CV_8UC4, pixels);\n};\np5.cv.imageDataToCvMat = function (imageData) {\n  return cv.matFromImageData(imageData);\n};\n// std::vector<cv::Point2f> toCv(const ofPolyline& polyline);\n// TODO: ask Golan if vectorsToCvMat is explanatory enough: this can represent a contour or a hull\np5.cv.vectorsToCvContour = function (points) {\n  // extract x,y points into value array and flatten that\n  return cv.matFromArray(\n    points.length,\n    1,\n    cv.CV_32SC2,\n    points.map((pt) => [pt.x, pt.y]).flat()\n  );\n};\np5.cv.colorToCvScalar = function (color) {\n  if (color instanceof p5.Color) {\n    return color.levels;\n  } else if (color instanceof Array) {\n    return color;\n  } else {\n    console.warn('unexpected color format', color);\n    return color;\n  }\n};\n// TODO: cv::Mat toCv(ofMesh& mesh);\n// cv::Point2f toCv(ofVec2f vec); -> not required as any object with x,y properties will do the job as an input\n// cv::Point3f toCv(ofVec3f vec); -> to be implemented later as OpenCV.js support for 3D improves\n// cv::Rect toCv(ofRectangle rect); -> not required as any object with x, y, width, height properties will do the job as an input\n// ofRectangle toOf(cv::Rect rect); -> not required as x, y, width, height properties can be accessed directly\n\n// ofPolyline toOf(cv::RotatedRect rect);\np5.cv.cvRotatedRectToPoints = function (rect) {\n  return cv.RotatedRect.points(rect);\n};\np5.cv.cvRotatedRectToVectors = function (rect) {\n  return p5.cv\n    .cvRotatedRectToPoints(rect)\n    .map((pt) => createVector(pt.x, pt.y));\n};\n// template <class T> inline ofPolyline toOf(const std::vector<cv::Point_<T> >& contour)\np5.cv.cvContourToPoints = function (contour) {\n  return p5.cv.cvPointsToJS(contour);\n};\n/* // toOf functions\n  // TODO: add p5.cv.cvMatToImageData()\n  template <class T>\n  void toOf(cv::Mat mat, ofPixels_<T>& pixels) {\n    pixels.setFromExternalPixels(mat.ptr<T>(), mat.cols, mat.rows, mat.channels());\n  }\n  template <class T>\n  void toOf(cv::Mat mat, ofImage_<T>& img) {\n    imitate(img, mat);\n    toOf(mat, img.getPixels());\n  } */\n\np5.cv.cvPointToVector = function (point) {\n  // TODO: check if _setupDone and display a useful error otherwise\n  return createVector(point.x, point.y);\n};\n\np5.cv.cvRectVectorToArray = function (rectVector, array) {\n  let rectVectorSize = rectVector.size();\n  for (let i = 0; i < rectVectorSize; i++) {\n    array.push(rectVector.get(i));\n  }\n};\n","p5.cv.ZERO_SCALAR = [0, 0, 0, 0];\n// Helpers.h\n// TODO: test ! test ! test !\n//new cv.Mat(3, 3, cv.CV_32FC1,0)\np5.cv.makeMatrix = function (rotation, translation) {\n  let rot3x3;\n  if (rotation.rows === 3 && rotation.cols === 3) {\n    rot3x3 = rotation;\n  } else {\n    //rot3x3 = new cv.Mat();\n    rot3x3 = new cv.Mat(3, 3, cv.CV_32FC1, p5.cv.ZERO_SCALAR);\n    cv.Rodrigues(rotation, rot3x3);\n  }\n  let rm = rot3x3.data32F;\n  let tm = translation.data32F;\n  // TODO: is this ok ? should it be Float32Array instead ?\n  // dafuq is this formatting, eslint?!\n  return [\n    rm[0],\n    rm[3],\n    rm[6],\n    0.0,\n    rm[1],\n    rm[4],\n    rm[7],\n    0.0,\n    rm[2],\n    rm[5],\n    rm[8],\n    0.0,\n    tm[0],\n    tm[1],\n    tm[2],\n    1.0,\n  ];\n};\n// TODO! test test test!\np5.cv.applyMatrix = function (transformationMatrix4x4) {\n  applyMatrix(...transformationMatrix4x4);\n};\n\np5.cv.drawMat = function (sourceMat, x, y, width, height) {\n  let p5Image = p5.cv.matToNewImage(sourceMat);\n  if (!width) width = sourceMat.cols;\n  if (!height) height = sourceMat.rows;\n  image(p5Image, x, y, width, height);\n  p5Image = null;\n};\n\np5.cv.drawVectors = function (vectors, close = true) {\n  let numVectors = vectors.length;\n  let vector;\n  beginShape();\n  for (let i = 0; i < numVectors; i++) {\n    vector = vectors[i];\n    vertex(vector.x, vector.y);\n  }\n  if (close) {\n    vector = vectors[0];\n    vertex(vector.x, vector.y);\n  }\n  endShape();\n};\n\np5.cv.drawRotatedRect = function (rotatedRect) {\n  let center = rotatedRect.center;\n  let size = rotatedRect.size;\n  push();\n  translate(center.x, center.y);\n  rotate(radians(rotatedRect.angle));\n  rect(-size.width * 0.5, -size.height * 0.5, size.width, size.height);\n  pop();\n};\n\np5.cv.drawRotatedEllipse = function (rotatedEllipse) {\n  let center = rotatedEllipse.center;\n  let size = rotatedEllipse.size;\n  push();\n  translate(center.x, center.y);\n  rotate(radians(rotatedEllipse.angle));\n  // p5.js uses ellipseMode(CENTER) by default\n  ellipse(0, 0, size.width, size.height);\n  pop();\n};\n\np5.cv.findMaxLocation = function (sourceMat) {\n  return cv.minMaxLoc(sourceMat).maxLoc;\n};\n// TODO: test: especially Mat type and data access\np5.cv.meanCols = function (sourceMat) {\n  let colMat = new cv.Mat(sourceMat.cols, 1, cv.CV_32FC1);\n  for (let i = 0; i < sourceMat.cols; i++) {\n    colMat.row(i).data32F[0] = cv.mean(sourceMat.col(i))[0];\n  }\n  return colMat;\n};\n\np5.cv.meanRows = function (sourceMat) {\n  let rowMat = new cv.Mat(sourceMat.rows, 1, cv.CV_32FC1);\n  for (let i = 0; i < sourceMat.cols; i++) {\n    rowMat.row(i).data32F[0] = cv.mean(sourceMat.row(i))[0];\n  }\n  return colMat;\n};\n\np5.cv.sumData = function (data) {\n  return data.reduce((a, b) => a + b);\n};\n\np5.cv.sumCols = function (sourceMat) {\n  let colMat = new cv.Mat(sourceMat.cols, 1, CV_32FC1);\n  for (let i = 0; i < sourceMat.cols; i++) {\n    // FIXME: cv.sum does not exist -> will col(i).data always work ?\n    colMat.row(i).data32F[0] = sourceMat.col(i).data.reduce((a, b) => a + b);\n  }\n  return colMat;\n};\n\np5.cv.sumRows = function (sourceMat) {\n  let rowMat = new cv.Mat(sourceMat.rows, 1, CV_32FC1);\n  for (let i = 0; i < sourceMat.rows; i++) {\n    // FIXME: cv.sum does not exist -> will data(i).data always work ?\n    rowMat.row(i).data32F[0] = sourceMat.row(i).data.reduce((a, b) => a + b);\n  }\n  return rowMat;\n};\n\np5.cv.minCols = function (sourceMat) {\n  let colMat = new cv.Mat(sourceMat.cols, 1, CV_32FC1);\n  for (let i = 0; i < sourceMat.cols; i++) {\n    colMat.row(i).data32F[0] = minMaxLoc(mat.col(i)).minVal;\n  }\n  return colMat;\n};\n\np5.cv.minRows = function (sourceMat) {\n  let rowMat = new cv.Mat(sourceMat.rows, 1, cv.CV_32FC1);\n  for (let i = 0; i < sourceMat.cols; i++) {\n    rowMat.row(i).data32F[0] = minMaxLoc(mat.row(i)).minVal;\n  }\n  return colMat;\n};\n\np5.cv.maxCols = function (sourceMat) {\n  let colMat = new cv.Mat(sourceMat.cols, 1, CV_32FC1);\n  for (let i = 0; i < sourceMat.cols; i++) {\n    colMat.row(i).data32F[0] = minMaxLoc(mat.col(i)).maxVal;\n  }\n  return colMat;\n};\n\np5.cv.maxRows = function (sourceMat) {\n  let rowMat = new cv.Mat(sourceMat.rows, 1, cv.CV_32FC1);\n  for (let i = 0; i < sourceMat.cols; i++) {\n    rowMat.row(i).data32F[0] = minMaxLoc(mat.row(i)).maxVal;\n  }\n  return colMat;\n};\n\np5.cv.findFirst = function (sourceMat, target) {\n  for (let i = 0; i < sourceMat.rows; i++) {\n    if (sourceMat.charAt(i) === target) {\n      return i;\n    }\n  }\n  return 0;\n};\n\np5.cv.findLast = function (sourceMat, target) {\n  for (let i = sourceMat.rows - 1; i >= 0; i--) {\n    if (sourceMat.charAt(i) === target) {\n      return i;\n    }\n  }\n  return 0;\n};\n\np5.cv.getBoundingBox = function (sourceMat, thresh, invert) {\n  let flags = invert ? cv.THRESH_BINARY_INV : cv.THRESH_BINARY;\n  let box = new cv.Rect();\n  let rowMat = p5.cv.meanRows(sourceMat);\n  cv.threshold(rowMat, rowMat, thresh, 255, flags);\n  box.y = p5.cv.findFirst(rowMat, 255);\n  box.height = p5.cv.findLast(rowMat, 255);\n  box.height -= box.y;\n\n  let colMat = p5.cv.meanCols(mat);\n  cv.threshold(colMat, colMat, thresh, 255, flags);\n  box.x = findFirst(colMat, 255);\n  box.width = findLast(colMat, 255);\n  box.width -= box.x;\n  return box;\n};\n\n// TODO: after October\n// // (nearest point) to the two given lines\n// template <class T>\n// cv::Point3_<T> intersectLineLine(cv::Point3_<T> lineStart1, cv::Point3_<T> lineEnd1, cv::Point3_<T> lineStart2, cv::Point3_<T> lineEnd2) {\n//     cv::Point3_<T> v1(lineEnd1 - lineStart1), v2(lineEnd2 - lineStart2);\n//     T v1v1 = v1.dot(v1), v2v2 = v2.dot(v2), v1v2 = v1.dot(v2), v2v1 = v2.dot(v1);\n//     cv::Mat_<T> lambda = (1. / (v1v1 * v2v2 - v1v2 * v1v2))\n//     * ((cv::Mat_<T>(2, 2) << v2v2, v1v2, v2v1, v1v1)\n//          * (cv::Mat_<T>(2, 1) << v1.dot(lineStart2 - lineStart1), v2.dot(lineStart1 - lineStart2)));\n//     return (1./2) * ((lineStart1 + v1 * lambda(0)) + (lineStart2 + v2 * lambda(1)));\n// }\n\n// (nearest point on a line) to the given point\n// template <class T>\n// cv::Point3_<T> intersectPointLine(cv::Point3_<T> point, cv::Point3_<T> lineStart, cv::Point3_<T> lineEnd) {\n//     cv::Point3_<T> ray = lineEnd - lineStart;\n//     T u = (point - lineStart).dot(ray) / ray.dot(ray);\n//     return lineStart + u * ray;\n// }\n\n// // (nearest point on a ray) to the given point\n// template <class T>\n// cv::Point3_<T> intersectPointRay(cv::Point3_<T> point, cv::Point3_<T> ray) {\n//     return ray * (point.dot(ray) / ray.dot(ray));\n// }\n\n// morphological thinning, also called skeletonization, strangely missing from opencv\n// here is a description of the algorithm http://homepages.inf.ed.ac.uk/rbf/HIPR2/thin.htm\n// template <class T>\n// void thin(T& img) {\n//     cv::Mat mat = toCv(img);\n//     int w = mat.cols, h = mat.rows;\n//     int ia1=-w-1,ia2=-w-0,ia3=-w+1,ib1=-0-1,ib3=-0+1,ic1=+w-1,ic2=+w-0,ic3=+w+1;\n//     unsigned char* p = mat.ptr<unsigned char>();\n//     vector<unsigned int> q;\n//     for(int y = 1; y + 1 < h; y++) {\n//         for(int x = 1; x + 1 < w; x++) {\n//             int i = y * w + x;\n//             if(p[i]) {\n//                 q.push_back(i);\n//             }\n//         }\n//     }\n//     int n = q.size();\n//     for(int i=0;i<n;i++){int j=q[i];if(!p[j+ia1]&&!p[j+ia2]&&!p[j+ia3]&&p[j+ic1]&&p[j+ic2]&&p[j+ic3]){p[j]=0;}}\n//     for(int i=0;i<n;i++){int j=q[i];if(!p[j+ia3]&&!p[j+ib3]&&!p[j+ic3]&&p[j+ia1]&&p[j+ib1]&&p[j+ic1]){p[j]=0;}}\n//     for(int i=0;i<n;i++){int j=q[i];if(!p[j+ic1]&&!p[j+ic2]&&!p[j+ic3]&&p[j+ia1]&&p[j+ia2]&&p[j+ia3]){p[j]=0;}}\n//     for(int i=0;i<n;i++){int j=q[i];if(!p[j+ia1]&&!p[j+ib1]&&!p[j+ic1]&&p[j+ia3]&&p[j+ib3]&&p[j+ic3]){p[j]=0;}}\n//     for(int i=0;i<n;i++){int j=q[i];if(!p[j+ia2]&&!p[j+ia3]&&!p[j+ib3]&&p[j+ib1]&&p[j+ic2]){p[j]=0;}}\n//     for(int i=0;i<n;i++){int j=q[i];if(!p[j+ib3]&&!p[j+ic3]&&!p[j+ic2]&&p[j+ib1]&&p[j+ia2]){p[j]=0;}}\n//     for(int i=0;i<n;i++){int j=q[i];if(!p[j+ic2]&&!p[j+ic1]&&!p[j+ib1]&&p[j+ia2]&&p[j+ib3]){p[j]=0;}}\n//     for(int i=0;i<n;i++){int j=q[i];if(!p[j+ib1]&&!p[j+ia1]&&!p[j+ia2]&&p[j+ic2]&&p[j+ib3]){p[j]=0;}}\n// }\n// additionally: https://github.com/LingDong-/skeletonization-js\n\n// given a vector of lines, this function will find the average angle\np5.cv.weightedAverageAngle = function (linesMat) {\n  let angleSum = 0;\n  let weights = 0;\n  for (let i = 0; i < linesMat.rows; i++) {\n    let start = new cv.Point(\n      linesMat.data32S[i * 4],\n      linesMat.data32S[i * 4 + 1]\n    );\n    let end = new cv.Point(\n      linesMat.data32S[i * 4 + 2],\n      linesMat.data32S[i * 4 + 3]\n    );\n    let diff = p5.Vector.sub(end, start);\n    let length = diff.mag();\n    let weight = length * length;\n    let angle = atan2(diff.y, diff.x);\n    angleSum += angle * weight;\n    weights += weight;\n  }\n  return angleSum / weights;\n};\n\n// finds the average angle of hough lines, unrotates by that amount and\n// returns the average rotation. you can supply your own thresholded image\n// for hough lines, or let it run canny detection for you.\np5.cv.autorotate = function (\n  sourceMat,\n  destinationMat,\n  threshold1 = 50,\n  threshold2 = 200\n) {\n  let threshMat = new cv.Mat();\n  cv.Canny(sourceMat, threshMat, threshold1, threshold2);\n  return autorotate(sourceMat, threshMat, destinationMat);\n};\n\np5.cv.autorotate = function (sourceMat, threshMat, destinationMat) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  let lines = new cv.Mat();\n  let distanceResolution = 1.0;\n  // FIXME check if this is correct: used to be CV_PI\n  let angleResolution = PI / 180;\n  // these three values are just heuristics that have worked for me\n  let voteThreshold = 10;\n  let minLineLength = (srcMat.rows + srcMat.cols) / 8;\n  let maxLineGap = 3;\n  cv.HoughLinesP(\n    threshMat,\n    lines,\n    distanceResolution,\n    angleResolution,\n    voteThreshold,\n    minLineLength,\n    maxLineGap\n  );\n  let rotationAmount = ofRadToDeg(weightedAverageAngle(lines));\n  p5.cv.rotate(sourceMat, destinationMat, rotationAmount);\n  return rotationAmount;\n};\n\n// OCT ?\n// p5.cv.getConvexPolygon(convexHull, targetPoints) {\n//     let result = convexHull;\n\n//     const maxIterations = 16;\n//     const infinity = Number.POSITIVE_INFINITY;\n//     let minEpsilon = 0;\n//     let maxEpsilon = Number.POSITIVE_INFINITY;\n//     let curEpsilon = 16; // good initial guess\n\n//     // unbounded binary search to simplify the convex hull until it's targetPoints\n//     if(result.size() > targetPoints) {\n//         for(let i = 0; i < maxIterations; i++) {\n//             cv.approxPolyDP(Mat(convexHull), result, curEpsilon, true);\n//             if(result.size() === targetPoints) {\n//                 break;\n//             }\n//             if(result.size() > targetPoints) {\n//                 minEpsilon = curEpsilon;\n//                 if(maxEpsilon === infinity) {\n//                     curEpsilon = curEpsilon *  2;\n//                 } else {\n//                     curEpsilon = (maxEpsilon + minEpsilon) / 2;\n//                 }\n//             }\n//             if(result.size() < targetPoints) {\n//                 maxEpsilon = curEpsilon;\n//                 curEpsilon = (maxEpsilon + minEpsilon) / 2;\n//             }\n//         }\n//     }\n\n//     return result;\n// }\n\n// TODO: rename these to imageToCvMat / cvMatToImage\np5.cv.imageToNewMat = function (sourceImage) {\n  // TODO: args safety check\n  return cv.imread(sourceImage.canvas);\n};\n\np5.cv.imageToMat = function (sourceImage, cvMat) {\n  let sourceWidth = sourceImage.width;\n  let sourceHeight = sourceImage.height;\n  if (!p5.cv.getAllocated(cvMat)) {\n    p5.cv.allocate(cvMat, sourceWidth, sourceHeight, cv.CV_8UC4);\n  }\n  let data = sourceImage.canvas\n    .getContext('2d')\n    .getImageData(0, 0, sourceWidth, sourceHeight).data;\n  cvMat.data.set(data);\n};\n\np5.cv.getCvVideoCapture = function (p5Capture) {\n  return new cv.VideoCapture(p5Capture.elt);\n};\n\np5.cv.getRGBAMat = function (width, height) {\n  return cv.Mat.zeros(height, width, cv.CV_8UC4);\n};\n\np5.cv.getRGBMat = function (width, height) {\n  return cv.Mat.zeros(height, width, cv.CV_8UC3);\n};\n\np5.cv.getGrayscaleMat = function (width, height) {\n  return cv.Mat.zeros(height, width, cv.CV_8UC1);\n};\n\np5.cv.matToImage = function (sourceMat, destinationImage) {\n  // TODO: args safety check\n  cv.imshow(destinationImage.canvas, sourceMat);\n};\n\np5.cv.matToNewImage = function (sourceMat) {\n  let destinationImage = createImage(sourceMat.cols, sourceMat.rows);\n  cv.imshow(destinationImage.canvas, sourceMat);\n  return destinationImage;\n};\n\np5.cv.areSamesize = function (matA, matB) {\n  return matA.rows === matB.rows && matA.cols === matB.cols;\n};\n\ncv.Scalar.sub = function (a, b) {\n  return [a[0] - b[0], a[1] - b[1], a[2] - b[2], a[3] - b[3]];\n};\n\ncv.Scalar.add = function (a, b) {\n  return [a[0] + b[0], a[1] + b[1], a[2] + b[2], a[3] + b[3]];\n};\n\ncv.Point.sub = function (a, b) {\n  return new cv.Point(a.x - b.x, a.x - b.x);\n};\n\ncv.Point.add = function (a, b) {\n  return new cv.Point(a.x + b.x, a.x + b.x);\n};\n","// wrapThree are based on functions that operate on three Mat objects.\n// the first two are inputs, and the third is an output. for example,\n// the min() function: min(x, y, result) will calculate the per-element min\n// between x and y, and store that in result. both y and result need to\n// match x in dimensions and type. while wrapThree functions will use\n// imitate() to make sure your data is allocated correctly, you shouldn't\n// epect the function to behave properly if you haven't already allocated\n// your y argument. in general, OF images contain noise when newly allocated\n// so the result will also contain that noise.\n// #define wrapThree(name) \\\n// template <class X, class Y, class Result>\\\n// void name(X& x, Y& y, Result& result) {\\\n// imitate(y, x);\\\n// imitate(result, x);\\\n// cv::Mat xMat = toCv(x), yMat = toCv(y);\\\n// cv::Mat resultMat = toCv(result);\\\n// cv::name(xMat, yMat, resultMat);\\\n// }\n\n// wrapThree(max);\n// wrapThree(min);\n// wrapThree(multiply);\n// wrapThree(divide);\n// wrapThree(add);\n// wrapThree(subtract);\n// wrapThree(absdiff);\n// wrapThree(bitwise_and);\n// wrapThree(bitwise_or);\n// wrapThree(bitwise_xor);\n\n// Wrappers.h\np5.cv.invertTo = function (sourceMat, destinationMat) {\n  // TODO: args safety check\n  cv.bitwise_not(sourceMat, destinationMat);\n};\n// inverting non-floating point images is a just a bitwise not operation\np5.cv.invert = function (sourceMat) {\n  // TODO: args safety check\n  p5.cv.invertTo(sourceMat, sourceMat);\n};\n// also useful for taking the average/mixing two images\np5.cv.lerp = function (lerpFromMat, lerpToMat, lerpResult, amount) {\n  // TODO: args safety check (including constraining amount)\n  if (lerpToMat.cols === 0) {\n    lerpFromMat.copyTo(lerpResult);\n  } else if (lerpFromMat.cols === 0) {\n    lerpToMat.copyTo(lerpResult);\n  } else {\n    cv.addWeighted(\n      lerpFromMat,\n      amount,\n      lerpToMat,\n      1.0 - amount,\n      0.0,\n      lerpResult\n    );\n  }\n};\np5.cv.accumulate = function (newMat, accumulatorMat) {\n  // FIXME: handle type differences, currently assumes sourceMat and destinationMat are the same type\n  cv.add(newMat, accumulatorMat, accumulatorMat);\n};\np5.cv.accumulateWeighted = function (\n  newMat,\n  accumulatorMat,\n  alpha,\n  mask = null\n) {\n  // imageA = alpha*imageA + (1-alpha)*imageB;\n  p5.cv.lerp(accumulatorMat, newMat, accumulatorMat, alpha);\n};\n// normalize the min/max to [0, max for this type] out of place\np5.cv.normalizeTo = function (sourceMat, destinationMat) {\n  // TODO: args safety check\n  cv.normalize(\n    sourceMat,\n    destinationMat,\n    0,\n    p5.cv.getMaxValForMat(destinationMat),\n    cv.NORM_MINMAX\n  );\n};\n// TODO: test more\n// normalize the min/max to [0, max for this type] in place\np5.cv.normalize = function (sourceMat) {\n  // TODO: args safety check\n  p5.cv.normalizeTo(sourceMat, sourceMat);\n};\n// TODO: test if invert does anything\n// threshold out of place\np5.cv.thresholdTo = function (\n  sourceMat,\n  destinationMat,\n  thresholdValue,\n  invert = false\n) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  let thresholdType = invert ? cv.THRESH_BINARY_INV : cv.THRESH_BINARY;\n  let maxVal = p5.cv.getMaxValForMat(destinationMat);\n  // cv.threshold(sourceMat, destinationMat, thresholdValue, maxVal, thresholdType);\n  cv.threshold(\n    sourceMat,\n    destinationMat,\n    thresholdValue,\n    maxVal,\n    thresholdType\n  );\n};\n// threshold in place\np5.cv.threshold = function (sourceMat, thresholdValue, invert = false) {\n  p5.cv.thresholdTo(sourceMat, sourceMat, thresholdValue, invert);\n};\n// cache reusable point\np5.cv.MINUS_ONE_POINT = new cv.Point(-1, -1);\n// FIXME: load cv nicely and cache this\n// p5.cv.DEFAULT_KERNEL_MAT = new cv.Mat();\n// erode out of place\np5.cv.erodeTo = function (sourceMat, destinationMat, iterations = 1) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  cv.erode(\n    sourceMat,\n    destinationMat,\n    new cv.Mat(),\n    p5.cv.MINUS_ONE_POINT,\n    iterations\n  );\n};\n// erode in place\np5.cv.erode = function (sourceMat, iterations = 1) {\n  p5.cv.erodeTo(sourceMat, sourceMat, iterations);\n};\n\n// dilate out of place\np5.cv.dilateTo = function (sourceMat, destinationMat, iterations = 1) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  cv.dilate(\n    sourceMat,\n    destinationMat,\n    new cv.Mat(),\n    p5.cv.MINUS_ONE_POINT,\n    iterations\n  );\n};\n\n// dilate in place\np5.cv.dilate = function (sourceMat, iterations = 1) {\n  p5.cv.dilateTo(sourceMat, sourceMat, iterations);\n};\n\n// automatic threshold (grayscale 8-bit only) out of place\np5.cv.autothresholdTo = function (sourceMat, destinationMat, invert = false) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  let flags =\n    cv.THRESH_OTSU | (invert ? cv.THRESH_BINARY_INV : cv.THRESH_BINARY);\n  cv.threshold(sourceMat, destinationMat, 0, 255, flags);\n};\n\n// automatic threshold (grayscale 8-bit only) in place\np5.cv.autothreshold = function (sourceMat, invert = false) {\n  p5.cv.autothresholdTo(sourceMat, sourceMat, invert);\n};\n\n// CV_RGB2GRAY, CV_HSV2RGB, etc. with [RGB, BGR, GRAY, HSV, HLS, XYZ, YCrCb, Lab, Luv]\n// you can convert whole images...\np5.cv.convertColor = function (sourceMat, destinationMat, code) {\n  // cvtColor allocates Mat for you, but we need this to handle ofImage etc.\n  let targetChannels = p5.cv.getTargetChannelsFromCode(code);\n  p5.cv.imitate(\n    destinationMat,\n    sourceMat,\n    p5.cv.getCvImageType(targetChannels, p5.cv.getDepthForMat(sourceMat))\n  );\n  cv.cvtColor(sourceMat, destinationMat, code);\n};\n// ...or single colors.\n// TODO: ask Golan about a decent way to tackle this.\n// return color (but have it clamped to 0-255) ?\n// test under different colorMode options\n// !!!!note it converts RGB, not RGB\np5.cv.convertSingleColor = function (p5Color, code) {\n  let mat = cv.Mat.zeros(1, 1, cv.CV_8UC3);\n  // TODO: check if array.length < 4, if fill in the blanks\n  let levels;\n  if (p5Color instanceof p5.Color) {\n    levels = p5Color.levels;\n  } else if (p5Color instanceof Array) {\n    levels = p5Color;\n  } else {\n    console.warn('unsupported format');\n    return mat.data;\n  }\n\n  mat.data[0] = levels[0];\n  mat.data[1] = levels[1];\n  mat.data[2] = levels[2];\n\n  cv.cvtColor(mat, mat, code);\n  let data = Array.from(mat.data);\n  // add alpha back in\n  data.push(levels[4]);\n  return data;\n};\n\n// a common cv task is to convert something to grayscale. this function will\n// do that quickly for RGBA, RGB, and 1-channel images.\np5.cv.copyGray = function (sourceMat, destinationMat) {\n  let channels = p5.cv.getChannelsForMat(sourceMat);\n  if (channels === 4) {\n    p5.cv.convertColor(sourceMat, destinationMat, cv.COLOR_RGBA2GRAY);\n  } else if (channels === 3) {\n    p5.cv.convertColor(sourceMat, destinationMat, cv.COLOR_RGB2GRAY);\n  } else if (channels === 1) {\n    sourceMat.copyTo(destinationMat);\n  }\n};\n\np5.cv.copyRGB = function (sourceMat, destinationMat) {\n  let channels = p5.cv.getChannelsForMat(sourceMat);\n  if (channels === 4) {\n    p5.cv.convertColor(sourceMat, destinationMat, cv.COLOR_RGBA2RGB);\n  } else if (channels === 3) {\n    sourceMat.copyTo(destinationMat);\n  } else if (channels === 1) {\n    p5.cv.convertColor(sourceMat, destinationMat, cv.COLOR_GRAY2RGB);\n  }\n};\n\np5.cv.forceOdd = function (x) {\n  return Math.floor(x / 2) * 2 + 1;\n};\n\n// box blur\np5.cv.blurTo = function (sourceMat, destinationMat, size) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  size = p5.cv.forceOdd(size);\n  cv.blur(sourceMat, destinationMat, new cv.Size(size, size));\n};\n// in-place box blur\np5.cv.blur = function (sourceMat, size) {\n  p5.cv.blurTo(sourceMat, sourceMat, size);\n};\n\n// Gaussian blur\np5.cv.GaussianBlurTo = function (sourceMat, destinationMat, size) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  size = p5.cv.forceOdd(size);\n  cv.GaussianBlur(sourceMat, destinationMat, new cv.Size(size, size), 0, 0);\n};\n\n// in-place Gaussian blur\np5.cv.GaussianBlur = function (sourceMat, size) {\n  p5.cv.GaussianBlurTo(sourceMat, sourceMat, size);\n};\n\n// Median blur\np5.cv.medianBlurTo = function (sourceMat, destinationMat, size) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  size = p5.cv.forceOdd(size);\n  cv.medianBlur(sourceMat, destinationMat, size);\n};\n\n// in-place Median blur\np5.cv.medianBlur = function (sourceMat, size) {\n  p5.cv.medianBlurTo(sourceMat, sourceMat, size);\n};\n\n// histogram equalization, adds support for color images\np5.cv.equalizeHistTo = function (sourceMat, destinationMat) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  if (sourceMat.channels() > 1) {\n    let sourceChannels = new cv.MatVector();\n    let destinationChannels = new cv.MatVector();\n    split(sourceMat, sourceChannels);\n    split(destinationMat, destinationChannels);\n    for (let i = 0; i < sourceChannels.size(); i++) {\n      cv.equalizeHist(sourceChannels.get(i), destinationChannels.get(i));\n    }\n    cv.merge(destinationChannels, destinationChannels);\n  } else {\n    cv.equalizeHist(sourceMat, destinationMat);\n  }\n};\n\np5.cv.equalizeHist = function (sourceMat) {\n  p5.cv.equalizeHistTo(sourceMat, sourceMat);\n};\n\n// Canny edge detection assumes your input and output are grayscale 8-bit\n// example thresholds might be 0,30 or 50,200\n// TODO: ask Golan if there's a reason to add an in-place version\np5.cv.Canny = function (\n  sourceMat,\n  destinationMat,\n  threshold1,\n  threshold2,\n  apertureSize = 3,\n  L2gradient = false\n) {\n  p5.cv.imitate(destinationMat, sourceMat, cv.CV_8UC1);\n  cv.Canny(\n    sourceMat,\n    destinationMat,\n    threshold1,\n    threshold2,\n    apertureSize,\n    L2gradient\n  );\n};\n\n// Sobel edge detection\np5.cv.Sobel = function (\n  sourceMat,\n  destinationMat,\n  ddepth = -1,\n  dx = 1,\n  dy = 1,\n  ksize = 3,\n  scale = 1,\n  delta = 0,\n  borderType = cv.BORDER_DEFAULT\n) {\n  p5.cv.imitate(destinationMat, sourceMat, cv.CV_8UC1);\n  cv.Sobel(\n    sourceMat,\n    destinationMat,\n    ddepth,\n    dx,\n    dy,\n    ksize,\n    scale,\n    delta,\n    borderType\n  );\n};\n// CLD missing at the moment\n\n// TODO: test ! test ! test!\n// dst does not imitate src\np5.cv.warpPerspective = function (\n  sourceMat,\n  destinationMat,\n  destinationPoints,\n  flags = cv.INTER_LINEAR\n) {\n  if (destinationPoints.type() !== cv.CV_32FC2) {\n    destinationPoints.convertTo(destinationPoints, cv.CV_32FC2);\n  }\n  // TODO validate args !!!\n  let w = sourceMat.cols;\n  let h = sourceMat.rows;\n  let sourcePoints = cv.matFromArray(4, 1, cv.CV_32FC2, [\n    0,\n    0,\n    w,\n    0,\n    w,\n    h,\n    0,\n    h,\n  ]);\n  if (destinationPoints instanceof Array) {\n    // FIXME: maybe convert this from [x1,y1,x2,y2,x3,y3...] to [{x:0,y:0}...] or [p5.Vector(),...]\n    destinationPoints = cv.matFromArray(4, 1, cv.CV_32FC2, destinationPoints);\n  }\n  let transform = cv.getPerspectiveTransform(sourcePoints, destinationPoints);\n  cv.warpPerspective(\n    sourceMat,\n    destinationMat,\n    transform,\n    destinationMat.size(),\n    flags\n  );\n};\n// dst does not imitate src\np5.cv.unwarpPerspective = function (\n  sourceMat,\n  destinationMat,\n  sourcePoints,\n  flags = cv.INTER_LINEAR\n) {\n  if (sourcePoints.type() !== cv.CV_32FC2) {\n    sourcePoints.convertTo(sourcePoints, cv.CV_32FC2);\n  }\n  let w = destinationMat.cols;\n  let h = destinationMat.rows;\n  let destinationPoints = cv.matFromArray(4, 1, cv.CV_32FC2, [\n    0,\n    0,\n    w,\n    0,\n    w,\n    h,\n    0,\n    h,\n  ]);\n\n  let transform = cv.getPerspectiveTransform(sourcePoints, destinationPoints);\n  cv.warpPerspective(\n    sourceMat,\n    destinationMat,\n    transform,\n    destinationMat.size(),\n    flags\n  );\n};\n\n// dst does not imitate src\np5.cv.warpPerspectiveFromTranform = function (\n  sourceMat,\n  destinationMat,\n  transform,\n  flags = cv.INTER_LINEAR\n) {\n  cv.warpPerspective(\n    sourceMat,\n    destinationMat,\n    transform,\n    destinationMat.size(),\n    flags\n  );\n};\n\n// also: INTER_NEAREST, INTER_AREA, INTER_CUBIC, INTER_LANCZOS4\np5.cv.resizeTo = function (\n  sourceMat,\n  destinationMat,\n  interpolation = cv.INTER_LINEAR\n) {\n  // TODO: validation args (especially destination Mat (e.g. width !=== 0, height !=== 0))\n  cv.resize(\n    sourceMat,\n    destinationMat,\n    destinationMat.size(),\n    0,\n    0,\n    interpolation\n  );\n};\n\n// also: INTER_NEAREST, INTER_AREA, INTER_CUBIC, INTER_LANCZOS4\np5.cv.resizeToScale = function (\n  sourceMat,\n  destinationMat,\n  xScale,\n  yScale,\n  interpolation = cv.INTER_LINEAR\n) {\n  let dstWidth = Math.floor(p5.cv.getWidth(sourceMat) * xScale),\n    dstHeight = Math.floor(p5.cv.getHeight(sourceMat) * yScale);\n  if (\n    p5.cv.getWidth(destinationMat) !== dstWidth ||\n    p5.cv.getHeight(destinationMat) !== dstHeight\n  ) {\n    p5.cv.allocate(\n      destinationMat,\n      dstWidth,\n      dstHeight,\n      p5.cv.getCvImageType(sourceMat)\n    );\n  }\n  cv.resize(\n    sourceMat,\n    destinationMat,\n    { width: dstWidth, height: dstHeight },\n    interpolation\n  );\n};\n\np5.cv.resizeToDimensions = function (\n  sourceMat,\n  destinationMat,\n  dstWidth,\n  dstHeight,\n  interpolation = cv.INTER_LINEAR\n) {\n  if (\n    p5.cv.getWidth(destinationMat) !== dstWidth ||\n    p5.cv.getHeight(destinationMat) !== dstHeight\n  ) {\n    p5.cv.allocate(\n      destinationMat,\n      dstWidth,\n      dstHeight,\n      p5.cv.getCvImageType(sourceMat)\n    );\n  }\n  cv.resize(\n    sourceMat,\n    destinationMat,\n    { width: dstWidth, height: dstHeight },\n    interpolation\n  );\n};\n\np5.cv.cvPointsToJS = function (mat) {\n  let result = [];\n  for (let i = 0; i < mat.rows; i++) {\n    result.push({ x: mat.data32S[i * 2], y: mat.data32S[i * 2 + 1] });\n  }\n  return result;\n};\n\np5.cv.drawContour = function (mat, close = true) {\n  beginShape();\n  for (let i = 0; i < mat.rows; i++) {\n    vertex(mat.data32S[i * 2], mat.data32S[i * 2 + 1]);\n  }\n  if (close) {\n    vertex(mat.data32S[0], mat.data32S[1]);\n  }\n  endShape();\n};\n\np5.cv.cvPointsToVectors = function (mat) {\n  let result = [];\n  for (let i = 0; i < mat.rows; i++) {\n    result.push(createVector(mat.data32S[i * 2], mat.data32S[i * 2 + 1]));\n  }\n  return result;\n};\n\np5.cv.cvFeaturesToPoints = function (mat) {\n  let result = [];\n  for (let i = 0; i < mat.rows; i++) {\n    result.push({ x: mat.data32F[i * 2], y: mat.data32F[i * 2 + 1] });\n  }\n  return result;\n};\n\np5.cv.getFeatureAsPoint = function (mat, index) {\n  return { x: mat.data32F[index * 2], y: mat.data32F[index * 2 + 1] };\n};\n\np5.cv.cvLineToJS = function (mat) {\n  let result = [];\n  for (let i = 0; i < mat.rows; i++) {\n    result.push({ x: mat.data32F[i * 2], y: mat.data32F[i * 2 + 1] });\n  }\n  return result;\n};\n\np5.cv.cvLineToVectors = function (mat) {\n  let result = [];\n  for (let i = 0; i < mat.rows; i++) {\n    result.push(createVector(mat.data32F[i * 2], mat.data32F[i * 2 + 1]));\n  }\n  return result;\n};\n\np5.cv.getConvexHullMat = function (contourMat) {\n  let hull = new cv.Mat();\n  cv.convexHull(contourMat, hull);\n  return hull;\n};\n\np5.cv.convexHullFromMat = function (contourMat) {\n  return p5.cv.cvPointsToJS(p5.cv.getConvexHullMat(contourMat));\n};\n\np5.cv.convexHull = function (vectors) {\n  let contour = p5.cv.vectorsToCvContour(vectors);\n  return p5.cv.convexHullFromMat(contour);\n};\n\np5.cv.convexityDefectsCv = function (contourMat) {\n  let hull = new cv.Mat();\n  let defects = new cv.Mat();\n  cv.convexHull(contourMat, hull, false, false);\n  cv.convexityDefects(contourMat, hull, defects);\n  return defects;\n};\n\np5.cv.convexityDefectsFromVectors = function (vectors) {\n  return p5.cv.cvPointsToVectors(\n    p5.cv.convexityDefectsCv(p5.cv.vectorsToCvContour(vectors))\n  );\n};\n\np5.cv.minAreaRectFromVectors = function (vectors) {\n  return cv.minAreaRect(p5.cv.vectorsToCvContour(vectors));\n};\n\np5.cv.fitEllipseFromVectors = function (vectors) {\n  return cv.fitEllipse(p5.cv.vectorsToCvContour(vectors));\n};\n// TODO: test more, fix as needed\np5.cv.fitLineFromVectors = function (vectors, height) {\n  let line = new cv.Mat();\n  cv.fitLine(\n    p5.cv.vectorsToCvContour(vectors),\n    line,\n    cv.DIST_L2,\n    0,\n    0.01,\n    0.01\n  );\n  // return p5.cv.cvLineToVectors(line);\n  // if(frameCount === 75){\n  //   console.log(line);\n  // }\n\n  let vx = line.data32F[0];\n  let vy = line.data32F[1];\n  let x = line.data32F[2];\n  let y = line.data32F[3];\n  let lefty = Math.round((-x * vy) / vx + y);\n  let righty = Math.round(((height - x) * vy) / vx + y);\n  let point1 = createVector(height - 1, righty);\n  let point2 = createVector(0, lefty);\n  return [point1, point2];\n};\n\n// TODO: test\n// kind of obscure function, draws filled polygons on the CPU\np5.cv.fillPoly = function (points, destinationMat) {\n  let numPoints = [points.length];\n  destinationMat.setTo(p5.cv.ZERO_SCALAR);\n  cv.fillPoly(destinationMat, points, numPoints, 1, [255, 255, 255, 255]);\n};\n\np5.cv.FLIP_HORIZONTAL = 1;\np5.cv.FLIP_VERTICAL = 0;\np5.cv.FLIP_BOTH = -1;\n\np5.cv.flipTo = function (sourceMat, destinationMat, code) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  cv.flip(sourceMat, destinationMat, code);\n};\n\np5.cv.flip = function (sourceMat, code) {\n  p5.cv.flipTo(sourceMat, sourceMat, code);\n};\n\n// if you're doing the same rotation multiple times, it's better to precompute\n// the displacement and use remap.\np5.cv.rotateTo = function (\n  sourceMat,\n  destinationMat,\n  angle,\n  fill = [0, 0, 0, 255],\n  interpolation = cv.INTER_LINEAR\n) {\n  p5.cv.imitate(destinationMat, sourceMat);\n  let center = new cv.Point(\n    Math.floor(sourceMat.cols * 0.5),\n    Math.floor(sourceMat.rows * 0.5)\n  );\n  let rotationMatrix = cv.getRotationMatrix2D(center, angle, 1);\n  cv.warpAffine(\n    sourceMat,\n    destinationMat,\n    rotationMatrix,\n    sourceMat.size(),\n    interpolation,\n    cv.BORDER_CONSTANT,\n    fill\n  );\n};\n\np5.cv.rotate = function (\n  sourceMat,\n  angle,\n  fill = [0, 0, 0, 255],\n  interpolation = cv.INTER_LINEAR\n) {\n  p5.cv.rotateTo(sourceMat, sourceMat, angle, fill, interpolation);\n};\n\n// efficient version of rotate that only operates on 0, 90, 180, 270 degrees\n// the output is allocated to contain all pixels of the input.\n// TODO: check if allocate calls are actually required!!!\np5.cv.rotate90To = function (sourceMat, destinationMat, angle) {\n  if (angle === 0) {\n    sourceMat.copyTo(destinationMat);\n  } else if (angle === 90) {\n    // p5.cv.allocate(destinationMat, sourceMat.rows, sourceMat.cols, sourceMat.type());\n    cv.transpose(sourceMat, destinationMat);\n    cv.flip(sourceMat, destinationMat, p5.cv.FLIP_HORIZONTAL);\n  } else if (angle === 180) {\n    p5.cv.imitate(destinationMat, sourceMat);\n    cv.flip(sourceMat, destinationMat, p5.cv.FLIP_BOTH);\n  } else if (angle === 270) {\n    // p5.cv.allocate(destinationMat, sourceMat.rows, sourceMat.cols, sourceMat.type());\n    cv.transpose(sourceMat, destinationMat);\n    // cv.flip(sourceMat, destinationMat, p5.cv.FLIP_VERTICAL);\n  }\n};\n\np5.cv.rotate90 = function (sourceMat, angle) {\n  p5.cv.rotate90To(sourceMat, sourceMat, angle);\n};\n\np5.cv.transposeTo = function (sourceMat, destinationMat) {\n  //p5.cv.allocate(destinationMat, sourceMat.rows, sourceMat.cols, sourceMat.type());\n  cv.transpose(sourceMat, destinationMat);\n};\n\np5.cv.transpose = function (sourceMat) {\n  p5.cv.transposeTo(sourceMat, sourceMat);\n};\n\np5.cv.swap = function (a, b) {\n  let temp = a.clone();\n  b.copyTo(a);\n  temp.copyTo(b);\n  temp.delete();\n};\n","p5.cv.trackingDistanceRect = function (a, b) {\n  let dx = a.x + a.width * 0.5 - (b.x + b.width * 0.5);\n  let dy = a.y + a.height * 0.5 - (b.y + b.height * 0.5);\n  let dw = a.width - b.width;\n  let dh = a.height - b.height;\n  let pd = Math.sqrt(dx * dx + dy * dy);\n  let sd = Math.sqrt(dw * dw + dh * dh);\n  return pd + sd;\n};\n\np5.cv.trackingDistancePoint = function (a, b) {\n  return dist(a.x, a.y, b.x, b.y);\n};\n\np5.cv.isPoint = function (pt) {\n  return 'x' in pt && 'y' in pt && !('width' in pt);\n};\n\np5.cv.isRect = function (pt) {\n  return 'x' in pt && 'y' in pt && 'width' in pt && 'height' in pt;\n};\n\np5.cv.trackingDistance = function (a, b) {\n  if (p5.cv.isPoint(a) && p5.cv.isPoint(b)) {\n    return p5.cv.trackingDistancePoint(a, b);\n  }\n  if (p5.cv.isRect(a) && p5.cv.isRect(b)) {\n    return p5.cv.trackingDistanceRect(a, b);\n  }\n  console.warn(\n    'invalid input: currently supporting only points(e.g. {x:0,y:0}) and rectangles({x:0,y:0,width:10,height:10})'\n  );\n  return -1;\n};\n\nclass TrackedObject {\n  initFromObject(object, label, index) {\n    this.lastSeen = 0;\n    this.label = label;\n    this.age = 0;\n    this.index = index;\n    this.object = object;\n    return this;\n  }\n\n  initFromPreviousObject(object, previous, index) {\n    this.lastSeen = 0;\n    this.label = previous.label;\n    this.age = previous.age;\n    this.index = index;\n    this.object = object;\n    return this;\n  }\n\n  copyFrom(old) {\n    this.lastSeen = old.lastSeen;\n    this.label = old.label;\n    this.age = old.age;\n    this.index = -1;\n    this.object = old.object;\n    return this;\n  }\n\n  timeStep(visible) {\n    this.age++;\n    if (!visible) {\n      this.lastSeen++;\n    }\n  }\n\n  getLastSeen() {\n    return this.lastSeen;\n  }\n\n  getAge() {\n    return this.age;\n  }\n\n  getLabel() {\n    return this.label;\n  }\n\n  getIndex() {\n    return this.index;\n  }\n}\n\nclass Tracker {\n  constructor() {\n    this.previous = [];\n    this.current = [];\n    this.currentLabels = [];\n    this.previousLabels = [];\n    this.newLabels = [];\n    this.deadLabels = [];\n\n    this.previousLabelMap = new Map();\n    this.currentLabelMap = new Map();\n\n    this.persistence = 15;\n    this.curLabel = 0;\n\n    this.maximumDistance = 64;\n  }\n\n  getNewLabel() {\n    return this.curLabel++;\n  }\n\n  setPersistence(persistence) {\n    this.persistance = persistence;\n  }\n\n  setMaximumDistance(maximumDistance) {\n    this.maximumDistance = maximumDistance;\n  }\n\n  sortByDistance(a, b) {\n    if (a.distance > b.distance) return 1;\n    if (a.distance < b.distance) return -1;\n    return 0;\n  }\n\n  track(objects) {\n    // TODO: check if this is mean to update reference or copy values\n    // this.previous = this.current;\n    this.previous = [].concat(this.current);\n\n    let n = objects.length;\n    let m = this.previous.length;\n\n    // matchPair = {index1:index2};\n    // matchDistancePair = {pair: matchPair, distance: dist}\n    let all = [];\n    for (let i = 0; i < n; i++) {\n      for (let j = 0; j < m; j++) {\n        let curDistance = p5.cv.trackingDistance(\n          objects[i],\n          this.previous[j].object\n        );\n        if (curDistance < this.maximumDistance) {\n          all.push({ pair: [i, j], distance: curDistance });\n        }\n      }\n    }\n\n    all.sort(this.sortByDistance);\n\n    // previousLabels = currentLabels;\n    this.previousLabels = [].concat(this.currentLabels);\n    this.currentLabels = new Array(n);\n    this.current.length = 0;\n\n    let matchedObjects = new Array(n).fill(false);\n    let matchedPrevious = new Array(m).fill(false);\n    // walk through matches in order\n    let allSize = all.length;\n    for (let k = 0; k < allSize; k++) {\n      let match = all[k].pair;\n      let i = match[0];\n      let j = match[1];\n      // only use match if both objects are unmatched, lastSeen is set to 0\n      if (!matchedObjects[i] && !matchedPrevious[j]) {\n        matchedObjects[i] = true;\n        matchedPrevious[j] = true;\n        let index = this.current.length;\n        let newFromPrevious = new TrackedObject().initFromPreviousObject(\n          objects[i],\n          this.previous[j],\n          index\n        );\n        this.current.push(newFromPrevious);\n        newFromPrevious.timeStep(true);\n        this.currentLabels[i] = newFromPrevious.getLabel();\n      }\n    }\n\n    // create new labels for new unmatched objects, lastSeen is set to 0\n    this.newLabels.length = 0;\n    for (let i = 0; i < n; i++) {\n      if (!matchedObjects[i]) {\n        let curLabel = this.getNewLabel();\n        let index = this.current.length;\n        let newWithLabel = new TrackedObject().initFromObject(\n          objects[i],\n          curLabel,\n          index\n        );\n        this.current.push(newWithLabel);\n        newWithLabel.timeStep(true);\n        this.currentLabels[i] = curLabel;\n        this.newLabels.push(curLabel);\n      }\n    }\n\n    // copy old unmatched objects if young enough, lastSeen is increased\n    this.deadLabels.length = 0;\n    for (let j = 0; j < m; j++) {\n      if (!matchedPrevious[j]) {\n        if (this.previous[j].getLastSeen() < this.persistence) {\n          this.current.push(this.previous[j]);\n          this.current[this.current.length - 1].timeStep(false);\n        }\n        this.deadLabels.push(this.previous[j].getLabel());\n      }\n    }\n\n    // build label maps\n    this.currentLabelMap.clear();\n    let currentSize = this.current.length;\n    for (let i = 0; i < currentSize; i++) {\n      let label = this.current[i].getLabel();\n      this.currentLabelMap.set(label, this.current[i]);\n    }\n    this.previousLabelMap.clear();\n    let previousSize = this.previous.length;\n    for (let i = 0; i < previousSize; i++) {\n      let label = this.previous[i].getLabel();\n      this.previousLabelMap.set(label, this.previous[i]);\n    }\n\n    return this.currentLabels;\n  }\n\n  getCurrentLabels() {\n    return this.currentLabels;\n  }\n\n  getPreviousLabels() {\n    return this.previousLabels;\n  }\n\n  getNewLabels() {\n    return this.newLabels;\n  }\n\n  getDeadLabels() {\n    return this.deadLabels;\n  }\n  getLabelFromIndex(i) {\n    return this.currentLabels[i];\n  }\n  // TODO: test with invalid label\n  getIndexFromLabel(label) {\n    if (this.currentLabelMap.has(label)) {\n      return this.currentLabelMap.get(label).getIndex();\n    }\n    console.warn('label', label, 'not found');\n  }\n  getPrevious(label) {\n    // return previousLabelMap.find(label)->second->object;\n    if (this.previousLabelMap.has(label)) {\n      return this.previousLabelMap.get(label).object;\n    }\n    console.warn('label', label, 'not found');\n  }\n  getCurrent(label) {\n    if (this.currentLabelMap.has(label)) {\n      return this.currentLabelMap.get(label).object;\n    }\n    console.warn('label', label, 'not found');\n  }\n  existsCurrent(label) {\n    return this.currentLabelMap.has(label);\n  }\n  existsPrevious(label) {\n    return this.previousLabelMap.has(label);\n  }\n  getAge(label) {\n    if (this.currentLabelMap.has(label)) {\n      return this.currentLabelMap.get(label).getAge();\n    }\n    console.warn('label', label, 'not found');\n  }\n  getLastSeen(label) {\n    if (this.currentLabelMap.has(label)) {\n      return this.currentLabelMap.get(label).getLastSeen();\n    }\n    console.warn('label', label, 'not found');\n  }\n}\n\nclass RectTracker extends Tracker {\n  constructor() {\n    super();\n    this.smoothingRate = 0.5;\n    // std::map<unsigned int, cv::Rect> smoothed;\n    this.smoothed = new Map();\n  }\n\n  setSmoothingRate(smoothingRate) {\n    this.smoothingRate = smoothingRate;\n  }\n  getSmoothingRate() {\n    return this.smoothingRate;\n  }\n\n  track(objects) {\n    let labels = super.track(objects);\n    // add new objects, update old objects\n    let labelsSize = labels.length;\n    for (let i = 0; i < labelsSize; i++) {\n      let label = labels[i];\n      let cur = this.getCurrent(label);\n      if (this.smoothed.has(label)) {\n        let smooth = this.smoothed.get(label);\n        smooth.x = lerp(smooth.x, cur.x, smoothingRate);\n        smooth.y = lerp(smooth.y, cur.y, smoothingRate);\n        smooth.width = lerp(smooth.width, cur.width, smoothingRate);\n        smooth.height = lerp(smooth.height, cur.height, smoothingRate);\n      } else {\n        this.smoothed[label] = cur;\n      }\n    }\n    // TODO: check if this is legit both global and instance p5.js modes\n    for (const [label, trackedRect] of this.smoothed.entries()) {\n      if (!this.existsCurrent(label)) {\n        this.smoothed.delete(label);\n        trackedRect; //eslint :/\n      }\n    }\n\n    return labels;\n  }\n\n  getSmoothed(label) {\n    if (this.smoothed.has(label)) {\n      return this.smoothed.get(label);\n    }\n    console.warn('label', label, 'not found');\n  }\n\n  getVelocity(i) {\n    let label = this.getLabelFromIndex(i);\n    // TODO: validate / handle i not found\n    if (this.existsPrevious(label)) {\n      let previous = this.getPrevious(label);\n      let current = this.getCurrent(label);\n      // TODO: check if this works: it's more readable, but looks like it could swallow memory over time\n      let previousPosition = createVector(\n        previous.x + previous.width * 0.5,\n        previous.y + previous.height * 0.5\n      );\n      let currentPosition = createVector(\n        current.x + current.width * 0.5,\n        current.y + current.height * 0.5\n      );\n      return p5.Vector.sub(currentPosition, previousPosition);\n    } else {\n      return createVector();\n    }\n  }\n}\n\n//   typedef Tracker<cv::Point2f> PointTracker;\nclass PointTracker extends Tracker {\n  constructor() {\n    super();\n  }\n}\n\nclass Follower {\n  constructor() {\n    this.dead = false;\n    this.label = 0;\n  }\n\n  setup(track) {}\n  update(track) {}\n  kill() {\n    this.dead = true;\n  }\n\n  setLabel(label) {\n    this.label = label;\n  }\n  getLabel() {\n    return this.label;\n  }\n  getDead() {\n    return this.dead;\n  }\n}\n\n// typedef Follower<cv::Rect> RectFollower;\n// typedef Follower<cv::Point2f> PointFollower;\nclass RectFollower extends Follower {\n  constructor() {\n    super();\n  }\n}\n\nclass PointFollower extends Follower {\n  constructor() {\n    super();\n  }\n}\n// FIXME: figure out the best way to handle RectTracker/PointTracker\nclass TrackerFollower extends Tracker {\n  constructor() {\n    super();\n    this.labels = [];\n    this.followers = [];\n  }\n\n  track(objects) {\n    // will this handle all types ?\n    super.track(objects);\n    // kill missing, update old\n    let labelsSize = this.labels.length;\n    for (let i = 0; i < labelsSize; i++) {\n      let curLabel = this.labels[i];\n      let curFollower = this.followers[i];\n      if (!this.existsCurrent(curLabel)) {\n        curFollower.kill();\n      } else {\n        curFollower.update(this.getCurrent(curLabel));\n      }\n    }\n    // add new\n    let newLabelsSize = this.newLabels.length;\n    for (let i = 0; i < newLabelsSize; i++) {\n      let curLabel = this.newLabels[i];\n      this.labels.push(curLabel);\n      let newFollower = new Follower();\n      this.followers.push(newFollower);\n      newFollower.setup(this.getCurrent(curLabel));\n      newFollower.setLabel(curLabel);\n    }\n    // remove dead\n    labelsSize = this.labels.length;\n    for (let i = labelsSize - 1; i >= 0; i--) {\n      if (this.followers[i].getDead()) {\n        this.followers.splice(i, 1);\n        this.labels.splice(i, 1);\n      }\n    }\n    return this.labels;\n  }\n\n  getFollowers() {\n    return this.followers;\n  }\n}\n\n// template <class F> class RectTrackerFollower : public TrackerFollower<cv::Rect, F> {};\n// template <class F> class PointTrackerFollower : public TrackerFollower<cv::Point2f, F> {};\nclass RectTrackerFollower extends TrackerFollower {\n  constructor() {\n    super();\n  }\n}\nclass PointTrackerFollower extends TrackerFollower {\n  constructor() {\n    super();\n  }\n}\n\nexport {\n  TrackedObject,\n  Tracker,\n  PointTracker,\n  RectTracker,\n  Follower,\n  RectFollower,\n  PointFollower,\n  TrackerFollower,\n  RectTrackerFollower,\n  PointTrackerFollower,\n};\n","const DifferenceMode = { ABSDIFF: 0, BRIGHTER: 1, DARKER: 2 };\n\nclass RunningBackground {\n  constructor(width, height) {\n    this.learningRate = 0.0001;\n    this.learningTime = 900.0;\n    this.useLearningTime = false;\n    this.thresholdValue = 26;\n    this.ignoreForeground = false;\n    this.needToReset = false;\n    this.differenceMode = DifferenceMode.ABSDIFF;\n    this.accumulator = new cv.Mat();\n    this.background = cv.Mat.zeros(height, width, cv.CV_32F);\n    this.foreground = cv.Mat.zeros(height, width, cv.CV_32F);\n    this.foregroundGray = cv.Mat.zeros(height, width, cv.CV_32F);\n  }\n\n  update(frame, thresholded) {\n    if (this.needToReset || this.accumulator.empty()) {\n      this.needToReset = false;\n      // frame.convertTo(this.accumulator, cv.CV_32F);\n      frame.copyTo(this.accumulator);\n    }\n\n    this.accumulator.convertTo(this.background, cv.CV_8U);\n    switch (this.differenceMode) {\n      case DifferenceMode.ABSDIFF:\n        cv.absdiff(this.background, frame, this.foreground);\n        break;\n      case DifferenceMode.BRIGHTER:\n        cv.subtract(frame, this.background, this.foreground);\n        break;\n      case DifferenceMode.DARKER:\n        cv.subtract(this.background, frame, this.foreground);\n        break;\n    }\n\n    p5.cv.copyGray(this.foreground, this.foregroundGray);\n    let thresholdMode = this.ignoreForeground\n      ? cv.THRESH_BINARY_INV\n      : cv.THRESH_BINARY;\n    cv.threshold(\n      this.foregroundGray,\n      thresholded,\n      this.thresholdValue,\n      255,\n      thresholdMode\n    );\n    // FIXME is this needed ?\n    let curLearningRate = float(this.learningRate);\n    if (this.useLearningTime) {\n      // FIXME: this needs more love\n      curLearningRate = pow(\n        1 - this.thresholdValue / 255,\n        1 / float(this.learningRate)\n      );\n    }\n    if (this.ignoreForeground) {\n      //   TODO: finish this: add mask\n      p5.cv.accumulateWeighted(frame, this.accumulator, curLearningRate);\n      // cv.bitwise_not(this.thresholded, this.thresholded);\n    } else {\n      p5.cv.accumulateWeighted(frame, this.accumulator, curLearningRate);\n    }\n  }\n\n  getPresence() {\n    return cv.mean(this.foreground).data[0] / 255.0;\n  }\n\n  setThresholdValue(thresholdValue) {\n    this.thresholdValue = thresholdValue;\n  }\n\n  setLearningRate(learningRate) {\n    this.learningRate = learningRate;\n    this.useLearningTime = false;\n  }\n\n  setLearningTime(learningTime) {\n    this.learningTime = learningTime;\n    this.useLearningTime = true;\n  }\n\n  setIgnoreForeground(ignoreForeground) {\n    this.ignoreForeground = ignoreForeground;\n  }\n\n  setDifferenceMode(differenceMode) {\n    this.differenceMode = differenceMode;\n  }\n\n  reset() {\n    this.needToReset = true;\n  }\n}\n\nexport default RunningBackground;\n","class ObjectFinder {\n  constructor() {\n    this.rescale = 1;\n    this.multiScaleFactor = 1.1;\n    this.minNeighbors = 3;\n    this.minSizeScale = new cv.Size();\n    this.maxSizeScale = new cv.Size(1, 1);\n    this.useHistogramEqualization = true;\n    this.cannyPrunning = false;\n    this.findBiggestObject = false;\n\n    this.gray = new cv.Mat();\n    this.graySmall = new cv.Mat();\n    this.classifier = new cv.CascadeClassifier();\n    // vector<Rect>\n    this.objects = [];\n    this.tracker = new RectTracker();\n  }\n\n  setup(cascadeFilename) {\n    // FIXME: handle load errors\n    this.classifier.load(cascadeFilename);\n  }\n\n  update(newFrameMat) {\n    if (this.classifier.empty()) {\n      return;\n    }\n    if (newFrameMat.channels() === 1) {\n      this.gray = newFrameMat;\n    } else {\n      p5.cv.copyGray(newFrameMat, this.gray);\n    }\n    p5.cv.resizeToScale(this.gray, this.graySmall, this.rescale, this.rescale);\n\n    if (this.useHistogramEqualization) {\n      p5.cv.equalizeHist(this.graySmall);\n    }\n    let minSize = new cv.Size(),\n      maxSize = new cv.Size();\n    let minSide = min(this.graySmall.rows, this.graySmall.cols);\n    if (this.minSizeScale > 0) {\n      let side = this.minSizeScale * minSide;\n      minSize.width = side;\n      minSize.height = side;\n    }\n    if (this.maxSizeScale < 1) {\n      let side = this.maxSizeScale * minSide;\n      // maxSize = new cv.Size(side, side);\n      maxSize.width = side;\n      maxSize.height = side;\n    }\n\n    let rectVector = new cv.RectVector();\n    this.classifier.detectMultiScale(\n      this.graySmall,\n      rectVector,\n      this.multiScaleFactor,\n      this.minNeighbors,\n      (this.cannyPruning ? cv.CASCADE_DO_CANNY_PRUNING : 0) |\n        (this.findBiggestObject\n          ? cv.CASCADE_FIND_BIGGEST_OBJECT | cv.CASCADE_DO_ROUGH_SEARCH\n          : 0),\n      minSize,\n      maxSize\n    );\n\n    this.objects.length = 0;\n    p5.cv.cvRectVectorToArray(rectVector, this.objects);\n    rectVector.delete();\n    let objectsSize = this.objects.length;\n    let rect;\n    for (let i = 0; i < objectsSize; i++) {\n      rect = this.objects[i];\n      // FIXME check if this is meant to be /= or *=\n      (rect.width /= this.rescale), (rect.height /= this.rescale);\n      (rect.x /= this.rescale), (rect.y /= this.rescale);\n      // // FIXME check if the above does the job by reference of we need the bellow re-assingment\n      this.objects[i] = rect;\n    }\n    this.tracker.track(this.objects);\n  }\n\n  size() {\n    return this.objects.length;\n  }\n\n  getObject(i) {\n    return this.objects[i];\n  }\n\n  getObjectSmoothed(i) {\n    return this.tracker.getSmoothed(this.getLabel(i));\n  }\n\n  getVelocity(i) {\n    return this.tracker.getVelocity(i);\n  }\n\n  getLabel(i) {\n    return this.tracker.getCurrentLabels()[i];\n  }\n\n  getTracker() {\n    return this.tracker;\n  }\n\n  draw() {\n    push();\n    noFill();\n    stroke(0, 192, 0);\n    let size = this.size();\n    let object;\n    for (let i = 0; i < size; i++) {\n      object = this.getObject(i);\n      rect(object.x, object.y, object.width, object.height);\n      text(this.getLabel(i), object.x, object.y - 3);\n    }\n    pop();\n  }\n\n  setPreset(preset) {\n    if (preset === ObjectFinder.FAST) {\n      this.setRescale(0.25);\n      this.setMinNeighbors(2);\n      this.setMultiScaleFactor(1.2);\n      this.setMinSizeScale(0.25);\n      this.setMaxSizeScale(0.75);\n      this.setCannyPruning(true);\n      this.setFindBiggestObject(false);\n    } else if (preset === ObjectFinder.ACCURATE) {\n      this.setRescale(0.5);\n      this.setMinNeighbors(6);\n      this.setMultiScaleFactor(1.02);\n      this.setMinSizeScale(0.1);\n      this.setMaxSizeScale(1);\n      this.setCannyPruning(true);\n      this.setFindBiggestObject(false);\n    } else if (preset === ObjectFinder.SENSITIVE) {\n      this.setRescale(0.5);\n      this.setMinNeighbors(1);\n      this.setMultiScaleFactor(1.02);\n      this.setMinSizeScale(0.1);\n      this.setMaxSizeScale(1);\n      this.setCannyPruning(false);\n      this.setFindBiggestObject(false);\n    }\n  }\n\n  setRescale(rescale) {\n    this.rescale = rescale;\n  }\n\n  setMinNeighbors(minNeighbors) {\n    this.minNeighbors = minNeighbors;\n  }\n\n  setMultiScaleFactor(multiScaleFactor) {\n    this.multiScaleFactor = multiScaleFactor;\n  }\n\n  setCannyPruning(cannyPruning) {\n    this.cannyPrunning = cannyPruning;\n  }\n\n  setFindBiggestObject(findBiggestObject) {\n    this.findBiggestObject = findBiggestObject;\n  }\n\n  setUseHistogramEqualization(useHistogramEqualization) {\n    this.useHistogramEqualization = useHistogramEqualization;\n  }\n\n  setMinSizeScale(minSizeScale) {\n    this.minSizeScale = minSizeScale;\n  }\n\n  setMaxSizeScale(maxSizeScale) {\n    this.maxSizeScale = maxSizeScale;\n  }\n}\n\nObjectFinder.FAST = 0;\nObjectFinder.ACCURATE = 1;\nObjectFinder.SENSITIVE = 2;\n\nexport default ObjectFinder;\n","class Flow {\n  constructor() {\n    this.last = new cv.Mat();\n    this.curr = new cv.Mat();\n    this.hasFlow = false;\n  }\n\n  //call these functions to calculate flow on sequential images.\n  //After this call the flow field will be populated and\n  //subsequent calls to getFlow() will be updated\n\n  //call with two contiguous images\n  calcOpticalFlowTo(lastMat, currentMat) {\n    if (lastMat.channels() === 1 && currentMat.channels() === 1) {\n      this.calcFlow(lastMat, currentMat);\n    } else {\n      p5.cv.copyGray(lastMat, this.last);\n      p5.cv.copyGray(currentMat, this.curr);\n      this.calcFlow(this.last, this.curr);\n    }\n    this.hasFlow = true;\n  }\n\n  //call with subsequent images to do running optical flow.\n  //the Flow class internally stores the last image for convenience\n  calcOpticalFlow(currentMat) {\n    p5.cv.copyGray(currentMat, this.curr);\n    let lastSize = this.last.size();\n    let currSize = this.curr.size();\n    if (\n      lastSize.width === currSize.width &&\n      lastSize.height === currSize.height\n    ) {\n      this.calcFlow(this.last, this.curr);\n      this.hasFlow = true;\n    }\n    p5.cv.swap(this.curr, this.last);\n  }\n\n  draw(x, y, renderWidth, renderHeight) {\n    x = x || 0;\n    y = y || 0;\n    renderWidth = renderWidth || width;\n    renderHeight = renderHeight || height;\n    if (this.hasFlow) {\n      this.drawFlow(x, y, width, height);\n    }\n  }\n\n  drawRect(rect) {\n    if (this.hasFlow) {\n      this.drawFlow(rect.x, rect.y, rect.width, rect.height);\n    }\n  }\n\n  getWidth() {\n    return this.curr.cols;\n  }\n\n  getHeight() {\n    return this.curr.rows;\n  }\n\n  resetFlow() {\n    this.last.setTo(p5.cv.ZERO_SCALAR);\n    this.curr.setTo(p5.cv.ZERO_SCALAR);\n    this.hasFlow = false;\n  }\n\n  // for subclass override\n  calcFlow(prevMat, nextMat) {}\n}\n\n//there are two implementations of Flow\n//use Farneback for a dense flow field,\n//use PyrLK for specific features\n\n//see http://opencv.willowgarage.com/documentation/cpp/motion_analysis_and_object_tracking.html\n//for more info on the meaning of these parameters\n\nclass FlowPyrLK extends Flow {\n  constructor() {\n    super();\n    this.prevPts = new cv.Mat();\n    this.nextPts = new cv.Mat();\n\n    //LK feature finding parameters\n    this.windowSize = new cv.Size(32, 32);\n    this.maxLevel = 3;\n    this.maxFeatures = 200;\n\n    // parameters for ShiTomasi corner detection\n    this.maxCorners = 30;\n    this.blockSize = 7;\n    this.qualityLevel = 0.01;\n    //min distance for PyrLK\n    this.minDistance = 4;\n\n    this.criteria = new cv.TermCriteria(\n      cv.TERM_CRITERIA_EPS | cv.TERM_CRITERIA_COUNT,\n      10,\n      0.03\n    );\n\n    //pyramid levels\n    this.pyramidLevels = 10;\n\n    this.calcFeaturesNextFrame = true;\n\n    //pyramid + err/status data\n    this.pyramid = new cv.Mat();\n    this.prevPyramid = new cv.Mat();\n    this.status = new cv.Mat();\n    this.err = new cv.Mat();\n  }\n\n  //flow parameters\n  setMinDistance(minDistance) {\n    this.minDistance = minDistance;\n  }\n  setWindowSize(winSize) {\n    this.windowSize.width = winSize;\n    this.windowSize.height = winSize;\n  }\n\n  //feature finding parameters\n  setMaxLevel(maxLevel) {\n    this.maxLevel = maxLevel;\n  }\n\n  setMaxFeatures(maxFeatures) {\n    this.maxFeatures = maxFeatures;\n  }\n\n  setQualityLevel(qualityLevel) {\n    this.qualityLevel = qualityLevel;\n  }\n\n  setPyramidLevels(levels) {\n    this.pyramidLevels = levels;\n  }\n\n  //returns tracking features for this image\n  getFeatures() {\n    // FIXME: make sure these are cv.Point like\n    return p5.cv.cvFeaturesToPoints(this.prevPts);\n  }\n\n  getCurrent() {\n    let result = [];\n    for (let i = 0; i < this.nextPts.rows; i++) {\n      if (this.status.data[i]) {\n        result.push(p5.cv.getFeatureAsPoint(this.nextPts, i));\n      }\n    }\n    return result;\n  }\n\n  getMotion() {\n    let result = [];\n    let featuresSize = this.prevPts.rows;\n    for (let i = 0; i < featuresSize; i++) {\n      if (this.status.data[i]) {\n        result.push(\n          cv.Point.sub(\n            p5.cv.getFeatureAsPoint(this.nextPts, i),\n            p5.cv.getFeatureAsPoint(this.prevPts, i)\n          )\n        );\n      }\n    }\n    return result;\n  }\n\n  // recalculates features to track\n  resetFeaturesToTrack() {\n    this.calcFeaturesNextFrame = true;\n  }\n  setFeaturesToTrack(features) {\n    this.nextPts = features;\n    this.calcFeaturesNextFrame = false;\n  }\n  resetFlow() {\n    super.resetFlow();\n    this.resetFeaturesToTrack();\n    this.prevPts = new cv.Mat();\n  }\n\n  drawFlow(drawX, drawY, drawWidth, drawHeight) {\n    let scaleX = drawWidth / width;\n    let scaleY = drawHeight / height;\n    let prevPtsSize = this.prevPts.rows;\n\n    beginShape(LINES);\n    for (let i = 0; i < prevPtsSize; i++) {\n      if (this.status.data[i]) {\n        vertex(\n          this.prevPts.data32F[i * 2] * scaleX + drawX,\n          this.prevPts.data32F[i * 2 + 1] * scaleY + drawY,\n          9\n        );\n\n        vertex(\n          this.nextPts.data32F[i * 2] * scaleX + drawX,\n          this.nextPts.data32F[i * 2 + 1] * scaleY + drawY,\n          9\n        );\n      }\n    }\n    endShape();\n  }\n\n  calcFlow(prevMat, nextMat) {\n    if (!this.nextPts.empty() || this.calcFeaturesNextFrame) {\n      if (this.calcFeaturesNextFrame) {\n        this.calcFeaturesToTrack(this.prevPts, nextMat);\n        this.calcFeaturesNextFrame = false;\n      } else {\n        p5.cv.swap(this.prevPts, this.nextPts);\n      }\n      this.nextPts.setTo(p5.cv.ZERO_SCALAR);\n\n      cv.calcOpticalFlowPyrLK(\n        prevMat,\n        nextMat,\n        this.prevPts,\n        this.nextPts,\n        this.status,\n        this.err,\n        this.windowSize,\n        this.maxLevel\n      );\n\n      // cv.calcOpticalFlowPyrLK(oldGray, frameGray, p0, p1, st, err, winSize, maxLevel, criteria);\n\n      // status.resize(nextPts.size(),0);\n    } else {\n      this.calcFeaturesToTrack(this.nextPts, nextMat);\n    }\n  }\n\n  calcFeaturesToTrack(features, nextMat) {\n    /* goodFeaturesToTrack arguments\n\n        image  single-channel 8-bit input image.\n        edges  output edge map; it has the same size and type as image .\n        threshold1  first threshold for the hysteresis procedure.\n        threshold2  second threshold for the hysteresis procedure.\n        apertureSize  aperture size for the Sobel() operator.\n        L2gradient - a flag, indicating whether a more accurate L_2 norm =\\sqrt{(dI/dx)^2 + (dI/dy)^2} should be used to calculate the image gradient magnitude ( L2gradient=true ), or whether the default L_1 norm =|dI/dx|+|dI/dy| is enough ( L2gradient=false ).\n        \n        cv.goodFeaturesToTrack(oldGray, p0, maxCorners, qualityLevel, minDistance, none, blockSize);\n\n        */\n    cv.goodFeaturesToTrack(\n      nextMat,\n      features,\n      this.maxFeatures,\n      this.qualityLevel,\n      this.minDistance\n    );\n  }\n}\n\nclass FlowFarneback extends Flow {\n  constructor() {\n    super();\n\n    this.flow = new cv.Mat();\n\n    this.pyramidScale = 0.5;\n    this.numLevels = 4;\n    this.windowSize = 8;\n    this.numIterations = 2;\n    this.polyN = 7;\n    this.polySigma = 1.5;\n    this.farnebackGaussian = false;\n    this.renderStep = 60;\n\n    // let frame2 = new cv.Mat(video.height, video.width, cv.CV_8UC4);\n    // let next = new cv.Mat(video.height, video.width, cv.CV_8UC1);\n    // let flow = new cv.Mat(video.height, video.width, cv.CV_32FC2);\n    // let flowVec = new cv.MatVector();\n    // let mag = new cv.Mat(video.height, video.width, cv.CV_32FC1);\n    // let ang = new cv.Mat(video.height, video.width, cv.CV_32FC1);\n    // let rgb = new cv.Mat(video.height, video.width, cv.CV_8UC3);\n  }\n\n  setPyramidScale(scale) {\n    if (scale < 0.0 || scale >= 1.0) {\n      console.warn(\n        'FlowFarneback::setPyramidScale',\n        'setting scale to a number outside of 0 - 1'\n      );\n      scale = constrain(scale, 0.0, 1.0);\n    }\n    this.pyramidScale = scale;\n  }\n  setNumLevels(levels) {\n    this.numLevels = levels;\n  }\n  setWindowSize(winSize) {\n    this.windowSize = winSize;\n  }\n  setNumIterations(iterations) {\n    this.numIterations = iterations;\n  }\n  setPolyN(polyN) {\n    this.polyN = polyN;\n  }\n  setPolySigma(polySigma) {\n    this.polySigma = polySigma;\n  }\n  setUseGaussian(gaussian) {\n    this.farnebackGaussian = gaussian;\n  }\n\n  //call this if you switch to a new video file to reset internal caches\n  resetFlow() {\n    super.resetFlow();\n    this.flow.setTo(p5.cv.ZERO_SCALAR);\n  }\n\n  calcFlow(prevMat, nextMat) {\n    let flags = 0;\n    if (this.hasFlow) {\n      flags = cv.OPTFLOW_USE_INITIAL_FLOW;\n    }\n    if (this.farnebackGaussian) {\n      flags |= cv.OPTFLOW_FARNEBACK_GAUSSIAN;\n    }\n    // cv.calcOpticalFlowFarneback(prevMat, nextMat, this.flow, 0.5, 3, 15, 3, 5, 1.2, 0);\n\n    cv.calcOpticalFlowFarneback(\n      prevMat,\n      nextMat,\n      this.flow,\n      this.pyramidScale,\n      this.numLevels,\n      this.windowSize,\n      this.numIterations,\n      this.polyN,\n      this.polySigma,\n      flags\n    );\n  }\n\n  getFlow() {\n    if (!hasFlow) {\n      this.flow = cv.Mat.zeros(1, 1, CV_32FC2);\n    }\n    return this.flow;\n  }\n\n  getTotalFlow() {\n    return this.getTotalFlowInRegion(0, 0, this.flow.cols, this.flow.rows);\n  }\n  getAverageFlow() {\n    return this.getAverageFlowInRegion(0, 0, this.flow.cols, this.flow.rows);\n  }\n  getFlowOffset(x, y) {\n    if (!this.hasFlow) {\n      return new cv.Point();\n    }\n    // (x + (y * w) ) * channels()\n    let xIndex = (x + y * this.flow.cols) * 2;\n    let yIndex = xIndex + 1;\n    return { x: this.flow.data32F[xIndex], y: this.flow.data32F[yIndex] };\n  }\n  getFlowPosition(x, y) {\n    let position = this.getFlowOffset(x, y);\n    position.x += x;\n    position.y += y;\n    return position;\n  }\n  getTotalFlowInRegion(regionX, regionY, regionWidth, regionHeight) {\n    if (!this.hasFlow) {\n      return new cv.Point(0, 0);\n    }\n\n    let x = 0;\n    let y = 0;\n    let total = this.flow.total();\n    let data = this.flow.data32F;\n\n    for (let i = 0; i < total; i++) {\n      let xIndex = i * 2;\n      let yIndex = i * 2 + 1;\n      x += data[xIndex];\n      y += data[yIndex];\n    }\n\n    return { x: x, y: y };\n  }\n\n  getAverageFlowInRegion(regionX, regionY, regionWidth, regionHeight) {\n    let flow = this.getTotalFlowInRegion(\n      regionX,\n      regionY,\n      regionWidth,\n      regionHeight\n    );\n    flow.x /= regionWidth;\n    flow.y /= regionHeight;\n    return flow;\n  }\n\n  drawFlow(rectX, rectY, rectWidth, rectHeight) {\n    if (!this.hasFlow) {\n      return;\n    }\n    let scaleX = rectWidth / this.flow.cols;\n    let scaleY = rectHeight / this.flow.rows;\n    console.log(rectWidth, rectHeight);\n    beginShape(LINES);\n    let flowPosition;\n    for (let y = 0; y < this.flow.rows; y += this.renderStep) {\n      for (let x = 0; x < this.flow.cols; x += this.renderStep) {\n        flowPosition = this.getFlowPosition(x, y);\n        vertex(x * scaleX + rectX, y * scaleY + rectY);\n        vertex(\n          flowPosition.x * scaleX + rectX,\n          flowPosition.y * scaleY + rectY\n        );\n      }\n    }\n    endShape();\n  }\n}\n\nclass Graph {\n  constructor(historyLength, minValue, maxValue) {\n    this.minValue = minValue;\n    this.maxValue = maxValue;\n    this.historyLength = historyLength;\n    this.history = new Float32Array(historyLength);\n    this.index = 0;\n  }\n\n  addSample(sample) {\n    this.history[this.index] = sample;\n    this.index = (this.index + 1) % this.historyLength;\n  }\n\n  getNormalizedSample(offset) {\n    var i = (this.index + offset) % this.historyLength;\n    var range = this.maxValue - this.minValue;\n    return (this.history[i] - this.minValue) / range;\n  }\n\n  draw(width, height) {\n    push();\n    noFill();\n    strokeWeight(1);\n    beginShape();\n    var range = this.maxValue - this.minValue;\n    for (var offset = 0; offset < this.historyLength; offset++) {\n      var i = (this.index + offset) % this.historyLength;\n      var x = (offset * width) / this.historyLength;\n      var normalized = (this.history[i] - this.minValue) / range;\n      var y = height - normalized * height;\n      vertex(x, y);\n    }\n    endShape();\n    pop();\n  }\n}\n\np5.cv.samePixels = function (a1, a2, stride, n) {\n  for (var i = 0; i < n; i += stride) {\n    if (a1[i] !== a2[i]) {\n      return false;\n    }\n  }\n  return true;\n};\n// TODO: review all functions that make new matrices and cleanup\np5.cv.same = function (matA, matB) {\n  let diff = new cv.Mat();\n  let matAGray = new cv.Mat();\n  let matBGray = new cv.Mat();\n  p5.cv.copyGray(matA, matAGray);\n  p5.cv.copyGray(matB, matBGray);\n  cv.absdiff(matAGray, matBGray, diff);\n  let same = cv.countNonZero(diff) === 0;\n  diff.delete();\n  matAGray.delete();\n  matBGray.delete();\n  return same;\n};\n\n// copied from https://github.com/anvaka/oflow\n\nclass OFlow extends Flow {\n  constructor() {\n    super();\n    this.step = 8;\n    this.flow = null;\n\n    this.uMotionGraph = new Graph(100, -this.step / 2, +this.step / 2);\n    this.vMotionGraph = new Graph(100, -this.step / 2, +this.step / 2);\n  }\n\n  calcOpticalFlow(currentMat) {\n    this.curr = currentMat;\n    let lastSize = this.last.size();\n    let currSize = this.curr.size();\n    if (\n      lastSize.width === currSize.width &&\n      lastSize.height === currSize.height\n    ) {\n      // TODO: profile CPU improvements\n      // cheap way to ignore duplicate frames\n      if (!p5.cv.samePixels(this.last.data, currentMat.data, 4, width)) {\n        this.calcFlow(this.last, this.curr);\n        this.hasFlow = true;\n      }\n    }\n    p5.cv.swap(this.curr, this.last);\n  }\n\n  // TODO: this could be simpler with OpenCV operations instead of individual byte access ?\n  // assumes rgba images, but only uses one channel\n  calcFlow(prevMat, nextMat) {\n    if (prevMat.type() !== cv.CV_8UC4 || nextMat.type() !== cv.CV_8UC4) {\n      console.warn('currently supporting only RGBA images');\n      this.hasFlow = false;\n      return;\n    }\n\n    let width = prevMat.cols;\n    let height = prevMat.rows;\n\n    let newImage = nextMat.data;\n    let oldImage = prevMat.data;\n\n    var zones = [];\n    var step = this.step;\n    var winStep = step * 2 + 1;\n\n    var A2, A1B2, B1, C1, C2;\n    var u, v, uu, vv;\n    uu = vv = 0;\n    var wMax = width - step - 1;\n    var hMax = height - step - 1;\n    var globalY, globalX, localY, localX;\n\n    for (globalY = step + 1; globalY < hMax; globalY += winStep) {\n      for (globalX = step + 1; globalX < wMax; globalX += winStep) {\n        A2 = A1B2 = B1 = C1 = C2 = 0;\n        // console.log('here',globalX,globalY);\n        for (localY = -step; localY <= step; localY++) {\n          for (localX = -step; localX <= step; localX++) {\n            var address = (globalY + localY) * width + globalX + localX;\n\n            var gradX =\n              newImage[(address - 1) * 4] - newImage[(address + 1) * 4];\n\n            var gradY =\n              newImage[(address - width) * 4] - newImage[(address + width) * 4];\n            var gradT = oldImage[address * 4] - newImage[address * 4];\n\n            A2 += gradX * gradX;\n            A1B2 += gradX * gradY;\n            B1 += gradY * gradY;\n            C2 += gradX * gradT;\n            C1 += gradY * gradT;\n          }\n        }\n\n        var delta = A1B2 * A1B2 - A2 * B1;\n\n        if (delta !== 0) {\n          /* system is not singular - solving by Kramer method */\n          var Idelta = step / delta;\n          var deltaX = -(C1 * A1B2 - C2 * B1);\n          var deltaY = -(A1B2 * C2 - A2 * C1);\n\n          u = deltaX * Idelta;\n          v = deltaY * Idelta;\n        } else {\n          /* singular system - find optical flow in gradient direction */\n          var norm = (A1B2 + A2) * (A1B2 + A2) + (B1 + A1B2) * (B1 + A1B2);\n          if (norm !== 0) {\n            var IGradNorm = step / norm;\n            var temp = -(C1 + C2) * IGradNorm;\n\n            u = (A1B2 + A2) * temp;\n            v = (B1 + A1B2) * temp;\n          } else {\n            u = v = 0;\n          }\n        }\n\n        if (-winStep < u && u < winStep && -winStep < v && v < winStep) {\n          uu += u;\n          vv += v;\n          zones.push(new cv.Rect(globalX, globalY, u, v));\n        }\n      }\n    }\n\n    this.flow = {\n      zones: zones,\n      u: uu / zones.length,\n      v: vv / zones.length,\n    };\n\n    this.hasFlow = true;\n\n    return this.flow;\n  }\n\n  drawFlow(rectX, rectY, rectWidth, rectHeight) {\n    if (!this.hasFlow) {\n      return;\n    }\n    let scaleX = rectWidth / this.curr.cols;\n    let scaleY = rectHeight / this.curr.rows;\n\n    if (this.flow && this.flow.u !== 0 && this.flow.v !== 0) {\n      this.uMotionGraph.addSample(this.flow.u);\n      this.vMotionGraph.addSample(this.flow.v);\n\n      strokeWeight(2);\n\n      let step = this.step;\n      this.flow.zones.forEach(function (zone) {\n        stroke(\n          map(zone.width, -step, +step, 0, 255),\n          map(zone.height, -step, +step, 0, 255),\n          128\n        );\n        line(\n          zone.x * scaleX + rectX,\n          zone.y * scaleY + rectY,\n          (zone.x + zone.width) * scaleX + rectX,\n          (zone.y + zone.height) * scaleY + rectY\n        );\n      });\n    }\n  }\n\n  plotGraphs(rectX, rectY, rectWidth, rectHeight) {\n    if (!this.hasFlow) {\n      return;\n    }\n    if (this.flow && this.flow.u !== 0 && this.flow.v !== 0) {\n      // draw left-right motion\n      this.uMotionGraph.draw(rectWidth, rectHeight / 2);\n      line(\n        rectX,\n        rectY + rectHeight / 4,\n        rectX + rectWidth,\n        rectY + rectHeight / 4\n      );\n\n      // draw up-down motion\n      translate(0, rectHeight / 2);\n      this.vMotionGraph.draw(rectWidth, rectHeight / 2);\n      line(\n        rectX,\n        rectY + rectHeight / 4,\n        rectX + rectWidth,\n        rectY + rectHeight / 4\n      );\n    }\n  }\n}\n\nexport { Flow, FlowPyrLK, FlowFarneback, OFlow, Graph };\n","p5.cv.TrackingColorMode = {\n  TRACK_COLOR_RGB: 0,\n  TRACK_COLOR_HSV: 1,\n  TRACK_COLOR_H: 2,\n  TRACK_COLOR_HS: 3,\n};\n\nclass ContourFinder {\n  constructor() {\n    this.hsvBuffer = new cv.Mat();\n    this.thresh = new cv.Mat();\n\n    this.autoThreshold = true;\n    this.invert = false;\n    this.simplify = true;\n\n    this.thresholdValue = 128;\n    this.thresholdValueMax = 255;\n\n    this.useTargetColor = false;\n    this.trackingColorMode = p5.cv.TrackingColorMode.TRACK_COLOR_HSV;\n    this.targetColor = color(0);\n\n    this.minArea = 0;\n    this.maxArea = Number.POSITIVE_INFINITY;\n\n    this.minAreaNorm = false;\n    this.maxAreaNorm = false;\n    // FIXME check of this needs will work as [] or Mat\n    this.contours = [];\n    this.polylines = [];\n\n    this.tracker = new RectTracker();\n    this.boundingRects = [];\n    this.holes = [];\n\n    this.contourFindingMode = cv.RETR_EXTERNAL;\n    this.sortBySize = false;\n\n    this.resetMinArea();\n    this.resetMaxArea();\n  }\n\n  findContours(sourceMat) {\n    // threshold the image using a tracked color or just binary grayscale\n    if (this.useTargetColor) {\n      // Scalar is equivalent to [0, 0, 0, 0]\n      let offset = [\n        this.thresholdValue,\n        this.thresholdValue,\n        this.thresholdValue,\n        0,\n      ];\n      let base = p5.cv.colorToCvScalar(this.targetColor);\n      if (this.trackingColorMode === p5.cv.TrackingColorMode.TRACK_COLOR_RGB) {\n        //inRange(img, base - offset, base + offset, thresh);\n        // cv.inRange(\n        //   sourceMat,\n        //   cv.Scalar.sub(base, offset),\n        //   cv.Scalar.add(base + offset),\n        //   this.thresh\n        // );\n        let lowerb = new cv.Mat(\n          sourceMat.rows,\n          sourceMat.cols,\n          sourceMat.type(),\n          cv.Scalar.sub(base, offset)\n        );\n        let upperb = new cv.Mat(\n          sourceMat.rows,\n          sourceMat.cols,\n          sourceMat.type(),\n          cv.Scalar.add(base, offset)\n        );\n        cv.inRange(sourceMat, lowerb, upperb, this.thresh);\n        lowerb.delete();\n        upperb.delete();\n      } else {\n        // all the HSV modes are broken incorrect,\n        // because opencv uses hue 0-180 not 0-255\n        // which means that the math doesn't wrap.\n        if (this.trackingColorMode === p5.cv.TrackingColorMode.TRACK_COLOR_H) {\n          offset[1] = 255;\n          offset[2] = 255;\n        }\n        if (this.trackingColorMode === p5.cv.TrackingColorMode.TRACK_COLOR_HS) {\n          offset[2] = 255;\n        }\n        if (!p5.cv.getAllocated(this.hsvBuffer)) {\n          p5.cv.imitate(this.hsvBuffer, sourceMat);\n        }\n        cv.cvtColor(sourceMat, this.hsvBuffer, cv.COLOR_RGBA2RGB);\n        cv.cvtColor(this.hsvBuffer, this.hsvBuffer, cv.COLOR_RGB2HSV);\n        base = p5.cv.convertSingleColor(this.targetColor, cv.COLOR_RGBA2RGB);\n        base = p5.cv.convertSingleColor(base, cv.COLOR_RGB2HSV);\n\n        let lowerb = new cv.Mat(\n          this.hsvBuffer.rows,\n          this.hsvBuffer.cols,\n          this.hsvBuffer.type(),\n          cv.Scalar.sub(base, offset)\n        );\n        let upperb = new cv.Mat(\n          this.hsvBuffer.rows,\n          this.hsvBuffer.cols,\n          this.hsvBuffer.type(),\n          cv.Scalar.add(base, offset)\n        );\n        cv.inRange(this.hsvBuffer, lowerb, upperb, this.thresh);\n        lowerb.delete();\n        upperb.delete();\n      }\n    } else {\n      p5.cv.copyGray(sourceMat, this.thresh);\n    }\n\n    if (this.autoThreshold) {\n      p5.cv.threshold(this.thresh, this.thresholdValue, this.invert);\n    }\n\n    // run the contour finder\n    let allContours = new cv.MatVector();\n    let hierarchy = new cv.Mat();\n    let simplifyMode = this.simplify\n      ? cv.CHAIN_APPROX_SIMPLE\n      : cv.CHAIN_APPROX_NONE;\n    cv.findContours(\n      this.thresh,\n      allContours,\n      hierarchy,\n      this.contourFindingMode,\n      simplifyMode\n    );\n\n    // filter the contours\n    let needMinFilter = this.minArea > 0;\n    let needMaxFilter = this.maxAreaNorm\n      ? this.maxArea < 1\n      : this.maxArea < Number.POSITIVE_INFINITY;\n    let allIndices = [];\n    let allAreas = [];\n    let allHoles = [];\n    if (needMinFilter || needMaxFilter) {\n      let imgArea = sourceMat.rows * sourceMat.cols;\n      let imgMinArea = this.minAreaNorm ? this.minArea * imgArea : this.minArea;\n      let imgMaxArea = this.maxAreaNorm ? this.maxArea * imgArea : this.maxArea;\n\n      for (let i = 0; i < allContours.size(); i++) {\n        let curArea = cv.contourArea(allContours.get(i), true);\n        let hole = true;\n        if (curArea < 0) {\n          curArea = -curArea;\n          hole = false;\n        }\n        allHoles.push(hole);\n        allAreas.push(curArea);\n        if (\n          (!needMinFilter || curArea >= imgMinArea) &&\n          (!needMaxFilter || curArea <= imgMaxArea)\n        ) {\n          allIndices.push(i);\n        }\n      }\n    } else {\n      for (let i = 0; i < allContours.size(); i++) {\n        if (this.sortBySize) {\n          allAreas.push(cv.contourArea(allContours.get(i)));\n        }\n        allIndices.push(i);\n      }\n    }\n\n    if (allIndices.length > 1 && this.sortBySize) {\n      // Sort contour indices, based on a separate vector of areas.\n      // Sort contour indices into decreasing order, based on a vector of\n      // contour areas.  Later, we will use these indices to order the\n      // contours (which are stored in a separate vector).\n      /* bool operator()(size_t a, size_t b) const\n            {\n                return mAreaVec[a] > mAreaVec[b];\n            } */\n      allIndices.sort((a, b) => {\n        if (allAreas[a] > allAreas[b]) return 1;\n        if (allAreas[a] < allAreas[b]) return -1;\n        return 0;\n      });\n    }\n\n    // generate polylines and bounding boxes from the contours\n    this.contours.length = 0;\n    this.polylines.length = 0;\n    this.boundingRects.length = 0;\n    this.holes.length = 0;\n    let allIndicesSize = allIndices.length;\n    for (let i = 0; i < allIndicesSize; i++) {\n      let contour = allContours.get(allIndices[i]);\n      this.contours.push(contour);\n      this.polylines.push(p5.cv.cvPointsToVectors(contour));\n      this.boundingRects.push(cv.boundingRect(contour));\n      this.holes.push(allHoles[allIndices[i]]);\n    }\n\n    // track bounding boxes\n    this.tracker.track(this.boundingRects);\n  }\n\n  setFindHoles(findHoles) {\n    if (findHoles) {\n      this.contourFindingMode = cv.RETR_LIST;\n    } else {\n      this.contourFindingMode = cv.RETR_EXTERNAL;\n    }\n  }\n\n  setSortBySize(sizeSort) {\n    this.sortBySize = sizeSort;\n  }\n\n  getContours() {\n    return this.contours;\n  }\n\n  getPolylines() {\n    return this.polylines;\n  }\n\n  getBoundingRects() {\n    return this.boundingRects;\n  }\n\n  size() {\n    return this.contours.length;\n  }\n\n  getContour(i) {\n    return this.contours[i];\n  }\n\n  getPolyline(i) {\n    return this.polylines[i];\n  }\n\n  getBoundingRect(i) {\n    return this.boundingRects[i];\n  }\n\n  getCenter(i) {\n    let box = this.getBoundingRect(i);\n    return new cv.Point(box.x + box.width * 0.5, box.y + box.height * 0.5);\n  }\n\n  getCentroid(i) {\n    let m = cv.moments(this.contours[i]);\n    if (m.m00 !== 0) {\n      return new cv.Point(m.m10 / m.m00, m.m01 / m.m00);\n    } else {\n      return new cvPoint(0, 0);\n    }\n  }\n\n  getAverage(i) {\n    let average = cv.mean(this.contours[i]);\n    return new cv.Point(average[0], average[1]);\n  }\n\n  getBalance(i) {\n    return cv.Point.sub(this.getCentroid(i), this.getCenter(i));\n  }\n\n  getContourArea(i) {\n    return cv.contourArea(this.contours[i]);\n  }\n\n  getArcLength(i) {\n    return cv.arcLength(this.contours[i], true);\n  }\n\n  getConvexHull(i) {\n    if (this.contours[i]) {\n      return p5.cv.getConvexHullMat(this.contours[i]);\n    }\n  }\n\n  getConvexityDefects(i) {\n    return p5.cv.convexityDefectsCv(this.contours[i]);\n  }\n\n  getMinAreaRect(i) {\n    return cv.minAreaRect(this.contours[i]);\n  }\n\n  getMinEnclosingCircle(i) {\n    return cv.minEnclosingCircle(this.contours[i]);\n  }\n\n  getFitEllipse(i) {\n    if (this.contours[i].total() < 5) {\n      return this.getMinAreaRect(i);\n    }\n    return cv.fitEllipse(this.contours[i]);\n  }\n\n  getFitQuad(i) {\n    let convexHull = this.getConvexHull(i);\n    if (!convexHull) {\n      return;\n    }\n    let quad = convexHull.clone();\n\n    const targetPoints = 4;\n    const maxIterations = 16;\n    const infinity = Number.POSITIVE_INFINITY;\n    let minEpsilon = 0;\n    let maxEpsilon = infinity;\n    let curEpsilon = 16; // good initial guess\n\n    // unbounded binary search to simplify the convex hull until it's 4 points\n    if (quad.total() > 4) {\n      for (let i = 0; i < maxIterations; i++) {\n        cv.approxPolyDP(convexHull, quad, curEpsilon, true);\n        if (quad.total() === targetPoints) {\n          break;\n        }\n        if (quad.total() > targetPoints) {\n          minEpsilon = curEpsilon;\n          if (maxEpsilon === infinity) {\n            curEpsilon = curEpsilon * 2;\n          } else {\n            curEpsilon = (maxEpsilon + minEpsilon) / 2;\n          }\n        }\n        if (quad.total() < targetPoints) {\n          maxEpsilon = curEpsilon;\n          curEpsilon = (maxEpsilon + minEpsilon) / 2;\n        }\n      }\n    }\n\n    return quad;\n  }\n\n  getHole(i) {\n    return this.holes[i];\n  }\n\n  getVelocity(i) {\n    return this.tracker.getVelocity(i);\n  }\n\n  getLabel(i) {\n    return this.tracker.getCurrentLabels()[i];\n  }\n\n  getTracker() {\n    return this.tracker;\n  }\n\n  setAutoThreshold(autoThreshold) {\n    this.autoThreshold = autoThreshold;\n  }\n\n  setThreshold(thresholdValue) {\n    this.thresholdValue = thresholdValue;\n  }\n  // FIXME: this might not actually be used\n  setThresholdMax(thresholdValueMax) {\n    this.thresholdValueMax = thresholdValueMax;\n  }\n\n  setInvert(invert) {\n    this.invert = invert;\n  }\n\n  setUseTargetColor(useTargetColor) {\n    this.useTargetColor = useTargetColor;\n  }\n\n  setTargetColor(targetColor, trackingColorMode) {\n    this.useTargetColor = true;\n    this.targetColor = targetColor;\n    this.trackingColorMode = trackingColorMode;\n  }\n\n  setSimplify(simplify) {\n    this.simplify = simplify;\n  }\n\n  draw() {\n    push();\n    noFill();\n    let polylinesSize = this.polylines.length;\n    for (let i = 0; i < polylinesSize; i++) {\n      p5.cv.drawVectors(this.polylines[i]);\n      let boundingRect = this.getBoundingRect(i);\n      rect(\n        boundingRect.x,\n        boundingRect.y,\n        boundingRect.width,\n        boundingRect.height\n      );\n    }\n    pop();\n  }\n\n  resetMinArea() {\n    this.setMinArea(0);\n  }\n\n  resetMaxArea() {\n    this.setMaxArea(Number.POSITIVE_INFINITY);\n  }\n\n  setMinArea(minArea) {\n    this.minArea = minArea;\n    this.maxAreaNorm = false;\n  }\n\n  setMaxArea(maxArea) {\n    this.maxArea = maxArea;\n    this.minAreaNorm = false;\n  }\n\n  setMinAreaRadius(minAreaRadius) {\n    this.minArea = PI * minAreaRadius * minAreaRadius;\n    this.minAreaNorm = false;\n  }\n\n  setMaxAreaRadius(maxAreaRadius) {\n    this.maxArea = PI * maxAreaRadius * maxAreaRadius;\n    this.maxAreaNorm = false;\n  }\n\n  setMinAreaNorm(minAreaNorm) {\n    this.minArea = minAreaNorm;\n    this.minAreaNorm = true;\n  }\n\n  setMaxAreaNorm(maxAreaNorm) {\n    this.maxArea = maxAreaNorm;\n    this.maxAreaNorm = true;\n  }\n}\n\nexport default ContourFinder;\n","import './p5.cv.utils';\nimport './p5.cv.utilities';\n\nimport './p5.cv.helpers';\nimport './p5.cv.wrappers';\n\nimport './p5.cv.tracker';\n\nimport {\n  TrackedObject,\n  Tracker,\n  PointTracker,\n  RectTracker,\n  Follower,\n  RectFollower,\n  PointFollower,\n  TrackerFollower,\n  RectTrackerFollower,\n  PointTrackerFollower,\n} from './p5.cv.tracker';\n\nwindow.Tracker = Tracker;\nwindow.TrackedObject = TrackedObject;\nwindow.RectTracker = RectTracker;\nwindow.PointTracker = PointTracker;\nwindow.Follower = Follower;\nwindow.RectFollower = RectFollower;\nwindow.PointFollower = PointFollower;\nwindow.TrackerFollower = TrackerFollower;\nwindow.RectTrackerFollower = RectTrackerFollower;\nwindow.PointTrackerFollower = PointTrackerFollower;\n\nimport RunningBackground from './p5.cv.running_background';\n\nwindow.RunningBackground = RunningBackground;\n\nimport ObjectFinder from './p5.cv.object_finder';\n\nwindow.ObjectFinder = ObjectFinder;\n\nimport { Flow, FlowPyrLK, FlowFarneback, OFlow, Graph } from './p5.cv.flow';\n\nwindow.Flow = Flow;\nwindow.FlowPyrLK = FlowPyrLK;\nwindow.FlowFarneback = FlowFarneback;\nwindow.OFlow = OFlow;\nwindow.Graph = Graph;\n\nimport './p5.cv.contour_finder';\nimport ContourFinder from './p5.cv.contour_finder';\n\nwindow.ContourFinder = ContourFinder;\n"],"sourceRoot":""}